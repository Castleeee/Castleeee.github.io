<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>pythonè¿›é˜¶ | ä¼šèµ°è·¯çš„ä¸‰ç™¾å—</title>
    <meta name="description" content="å¹´è½»äººçš„åšå®¢">
    <link rel="icon" href="/logo1.ico" type="image/x-icon">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.d22626bb.css" as="style"><link rel="preload" href="/assets/js/app.64171550.js" as="script"><link rel="preload" href="/assets/js/68.3b9433a6.js" as="script"><link rel="preload" href="/assets/js/38.34e99c36.js" as="script"><link rel="prefetch" href="/assets/js/10.f30e4bf5.js"><link rel="prefetch" href="/assets/js/100.14a8b555.js"><link rel="prefetch" href="/assets/js/101.9e257240.js"><link rel="prefetch" href="/assets/js/11.c050169c.js"><link rel="prefetch" href="/assets/js/12.9abd0678.js"><link rel="prefetch" href="/assets/js/13.ca763ee5.js"><link rel="prefetch" href="/assets/js/14.69f05fca.js"><link rel="prefetch" href="/assets/js/15.db5225be.js"><link rel="prefetch" href="/assets/js/16.c6de58f6.js"><link rel="prefetch" href="/assets/js/17.a33727a2.js"><link rel="prefetch" href="/assets/js/18.78f0824a.js"><link rel="prefetch" href="/assets/js/19.20a4f3cf.js"><link rel="prefetch" href="/assets/js/20.15fb9aec.js"><link rel="prefetch" href="/assets/js/21.c2410e24.js"><link rel="prefetch" href="/assets/js/22.6423d49a.js"><link rel="prefetch" href="/assets/js/23.1b0b2120.js"><link rel="prefetch" href="/assets/js/24.93132bac.js"><link rel="prefetch" href="/assets/js/25.a334198a.js"><link rel="prefetch" href="/assets/js/26.c1c7aaa3.js"><link rel="prefetch" href="/assets/js/27.2c86a0cd.js"><link rel="prefetch" href="/assets/js/28.a9d5d0ae.js"><link rel="prefetch" href="/assets/js/29.82f2e489.js"><link rel="prefetch" href="/assets/js/3.465cd447.js"><link rel="prefetch" href="/assets/js/30.d0c8250c.js"><link rel="prefetch" href="/assets/js/31.e6286844.js"><link rel="prefetch" href="/assets/js/32.116769da.js"><link rel="prefetch" href="/assets/js/33.38e22b91.js"><link rel="prefetch" href="/assets/js/34.21d15ece.js"><link rel="prefetch" href="/assets/js/35.53517849.js"><link rel="prefetch" href="/assets/js/36.9b848dcf.js"><link rel="prefetch" href="/assets/js/37.bf3574bb.js"><link rel="prefetch" href="/assets/js/39.10a54121.js"><link rel="prefetch" href="/assets/js/4.9d750d27.js"><link rel="prefetch" href="/assets/js/40.0ead9dc2.js"><link rel="prefetch" href="/assets/js/41.16bfab2f.js"><link rel="prefetch" href="/assets/js/42.b0388f8b.js"><link rel="prefetch" href="/assets/js/43.1d51bbcb.js"><link rel="prefetch" href="/assets/js/44.9e15a8ac.js"><link rel="prefetch" href="/assets/js/45.c9a7ee30.js"><link rel="prefetch" href="/assets/js/46.0821d6b3.js"><link rel="prefetch" href="/assets/js/47.fdd4b2c4.js"><link rel="prefetch" href="/assets/js/48.c86a3241.js"><link rel="prefetch" href="/assets/js/49.29d7cdaf.js"><link rel="prefetch" href="/assets/js/5.b5540d72.js"><link rel="prefetch" href="/assets/js/50.88cae993.js"><link rel="prefetch" href="/assets/js/51.39b0672d.js"><link rel="prefetch" href="/assets/js/52.47b9c89c.js"><link rel="prefetch" href="/assets/js/53.561866dc.js"><link rel="prefetch" href="/assets/js/54.44ad8aef.js"><link rel="prefetch" href="/assets/js/55.999cd3f5.js"><link rel="prefetch" href="/assets/js/56.0fc25a14.js"><link rel="prefetch" href="/assets/js/57.fbeec51d.js"><link rel="prefetch" href="/assets/js/58.c2c3e960.js"><link rel="prefetch" href="/assets/js/59.388b8a2f.js"><link rel="prefetch" href="/assets/js/6.9305fa77.js"><link rel="prefetch" href="/assets/js/60.3bab7106.js"><link rel="prefetch" href="/assets/js/61.fab74e1f.js"><link rel="prefetch" href="/assets/js/62.b8451d9d.js"><link rel="prefetch" href="/assets/js/63.1ea19cc7.js"><link rel="prefetch" href="/assets/js/64.21f37b67.js"><link rel="prefetch" href="/assets/js/65.79da4678.js"><link rel="prefetch" href="/assets/js/66.2276f1ea.js"><link rel="prefetch" href="/assets/js/67.cf3e97e4.js"><link rel="prefetch" href="/assets/js/69.a6723b19.js"><link rel="prefetch" href="/assets/js/7.8235c05c.js"><link rel="prefetch" href="/assets/js/70.eff0cc02.js"><link rel="prefetch" href="/assets/js/71.577ad016.js"><link rel="prefetch" href="/assets/js/72.ee1b8084.js"><link rel="prefetch" href="/assets/js/73.ce23853b.js"><link rel="prefetch" href="/assets/js/74.e51d0dc7.js"><link rel="prefetch" href="/assets/js/75.3fbf6e41.js"><link rel="prefetch" href="/assets/js/76.1ad79723.js"><link rel="prefetch" href="/assets/js/77.05aaa2f4.js"><link rel="prefetch" href="/assets/js/78.9e4bf317.js"><link rel="prefetch" href="/assets/js/79.028f9c41.js"><link rel="prefetch" href="/assets/js/8.a4265244.js"><link rel="prefetch" href="/assets/js/80.a83e9fee.js"><link rel="prefetch" href="/assets/js/81.e20ef630.js"><link rel="prefetch" href="/assets/js/82.0a2c28d1.js"><link rel="prefetch" href="/assets/js/83.84f22d3a.js"><link rel="prefetch" href="/assets/js/84.8c0c443d.js"><link rel="prefetch" href="/assets/js/85.1473a2e2.js"><link rel="prefetch" href="/assets/js/86.4683653f.js"><link rel="prefetch" href="/assets/js/87.9507aa61.js"><link rel="prefetch" href="/assets/js/88.77ce595e.js"><link rel="prefetch" href="/assets/js/89.d25806a8.js"><link rel="prefetch" href="/assets/js/9.56b90d44.js"><link rel="prefetch" href="/assets/js/90.231b245f.js"><link rel="prefetch" href="/assets/js/91.cb1ec410.js"><link rel="prefetch" href="/assets/js/92.10cedbd9.js"><link rel="prefetch" href="/assets/js/93.575cc043.js"><link rel="prefetch" href="/assets/js/94.9233e13a.js"><link rel="prefetch" href="/assets/js/95.fafa9bc4.js"><link rel="prefetch" href="/assets/js/96.8b941223.js"><link rel="prefetch" href="/assets/js/97.49080105.js"><link rel="prefetch" href="/assets/js/98.82d1cc72.js"><link rel="prefetch" href="/assets/js/99.d78b0b9a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.0cd5f832.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d22626bb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><div><header id="navbarWrapper" class="navbar"><div class="sidebar-button"><i class="iconfont reco-menu"></i></div> <a href="/" class="home-link router-link-active"><img src="/head3.png" alt="ä¼šèµ°è·¯çš„ä¸‰ç™¾å—" class="logo"> <span class="site-name">ä¼šèµ°è·¯çš„ä¸‰ç™¾å—</span></a> <div class="links" style="max-width:nullpx;"><div class="side-search-wrapper"><div class="search-box" data-v-1b2e3b29><input aria-label="Search" autocomplete="off" spellcheck="false" value="" data-v-1b2e3b29> <i class="iconfont reco-search" data-v-1b2e3b29></i> <!----></div></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/backEnd.html" class="nav-link"><i class="iconfont undefined"></i>
  åç«¯
</a></li><li class="dropdown-item"><!----> <a href="/categories/frontEnd.html" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/categories/bigData.html" class="nav-link"><i class="iconfont undefined"></i>
  å¤§æ•°æ®
</a></li><li class="dropdown-item"><!----> <a href="/categories/Distributed.html" class="nav-link"><i class="iconfont undefined"></i>
  åˆ†å¸ƒå¼
</a></li><li class="dropdown-item"><!----> <a href="/categories/life.html" class="nav-link"><i class="iconfont undefined"></i>
  æ—¥è®°
</a></li></ul></div></div><div class="nav-item"><a href="/tags/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div><div class="nav-item"><a href="/categories/article.html" class="nav-link"><i class="iconfont reco-up"></i>
  Library
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/about.html" class="nav-link"><i class="iconfont reco-account"></i>
  about me
</a></div><div class="nav-item"><a href="https://www.jianshu.com/u/04777e91e2ef" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-jianshu"></i>
  ç®€ä¹¦
  </a></div><div class="nav-item"><a href="https://github.com/Castleeee" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  </a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><div class="side-search-wrapper"><div class="search-box" data-v-1b2e3b29><input aria-label="Search" autocomplete="off" spellcheck="false" value="" data-v-1b2e3b29> <i class="iconfont reco-search" data-v-1b2e3b29></i> <!----></div></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/backEnd.html" class="nav-link"><i class="iconfont undefined"></i>
  åç«¯
</a></li><li class="dropdown-item"><!----> <a href="/categories/frontEnd.html" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/categories/bigData.html" class="nav-link"><i class="iconfont undefined"></i>
  å¤§æ•°æ®
</a></li><li class="dropdown-item"><!----> <a href="/categories/Distributed.html" class="nav-link"><i class="iconfont undefined"></i>
  åˆ†å¸ƒå¼
</a></li><li class="dropdown-item"><!----> <a href="/categories/life.html" class="nav-link"><i class="iconfont undefined"></i>
  æ—¥è®°
</a></li></ul></div></div><div class="nav-item"><a href="/tags/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div><div class="nav-item"><a href="/categories/article.html" class="nav-link"><i class="iconfont reco-up"></i>
  Library
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/about.html" class="nav-link"><i class="iconfont reco-account"></i>
  about me
</a></div><div class="nav-item"><a href="https://www.jianshu.com/u/04777e91e2ef" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-jianshu"></i>
  ç®€ä¹¦
  </a></div><div class="nav-item"><a href="https://github.com/Castleeee" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  </a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><!----></p> <ul class="sidebar-group-items"><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#pythonä¸­ä¸€åˆ‡çš†å¯¹è±¡" class="sidebar-link">pythonä¸­ä¸€åˆ‡çš†å¯¹è±¡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å¯¹è±¡çš„äº§ç”Ÿ" class="sidebar-link">å¯¹è±¡çš„äº§ç”Ÿ</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#pythonä¸­ä¸åŒçš„ç±»å‹" class="sidebar-link">pythonä¸­ä¸åŒçš„ç±»å‹</a></li></ul></li><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#é­”æ³•å‡½æ•°" class="sidebar-link">é­”æ³•å‡½æ•°</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#éæ•°å­¦è¿ç®—ç±»" class="sidebar-link">éæ•°å­¦è¿ç®—ç±»</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#æ•°å­¦è¿ç®—ç±»" class="sidebar-link">æ•°å­¦è¿ç®—ç±»</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#str-å’Œ-repr" class="sidebar-link">str å’Œ repr</a></li></ul></li><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#é¸­å­ç±»å‹å’Œpythonçš„å¤šæ€æ€§" class="sidebar-link">é¸­å­ç±»å‹å’Œpythonçš„å¤šæ€æ€§</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#ä»€ä¹ˆæ˜¯é¸­å­" class="sidebar-link">ä»€ä¹ˆæ˜¯é¸­å­</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#æŠ½è±¡åŸºç±»" class="sidebar-link">æŠ½è±¡åŸºç±»</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#åŠŸèƒ½ç±»mixinå’Œå˜é‡æœºåˆ¶" class="sidebar-link">åŠŸèƒ½ç±»MixInå’Œå˜é‡æœºåˆ¶</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#ç±»æ–¹æ³•å’Œé™æ€æ–¹æ³•" class="sidebar-link">ç±»æ–¹æ³•å’Œé™æ€æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#è‡ªçœæœºåˆ¶" class="sidebar-link">è‡ªçœæœºåˆ¶</a></li></ul></li><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#åŸºäºåè®®çš„python" class="sidebar-link">åŸºäºåè®®çš„python</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#ä¸Šä¸‹æ–‡ç®¡ç†åè®®" class="sidebar-link">ä¸Šä¸‹æ–‡ç®¡ç†åè®®</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#åºåˆ—ç›¸å…³åè®®" class="sidebar-link">åºåˆ—ç›¸å…³åè®®</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#mappingç±»å‹åè®®" class="sidebar-link">Mappingç±»å‹åè®®</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#collectionsçš„ç”¨æ³•" class="sidebar-link">collectionsçš„ç”¨æ³•</a></li></ul></li><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#ä¸‰ç¥å™¨" class="sidebar-link">ä¸‰ç¥å™¨</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#è£…é¥°å™¨-ç•™å‘" class="sidebar-link">è£…é¥°å™¨(ç•™å‘)</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å±æ€§æŸ¥æ‰¾è¿‡ç¨‹" class="sidebar-link">å±æ€§æŸ¥æ‰¾è¿‡ç¨‹</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#è¿­ä»£å™¨" class="sidebar-link">è¿­ä»£å™¨</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#ç”Ÿæˆå™¨" class="sidebar-link">ç”Ÿæˆå™¨</a></li></ul></li><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#websocket" class="sidebar-link">WebSocket</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#åŸºæœ¬çš„api" class="sidebar-link">åŸºæœ¬çš„API</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#tcp-udpçš„ä½¿ç”¨ä»£ç " class="sidebar-link">TCP/UDPçš„ä½¿ç”¨ä»£ç </a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#socketserverçš„ä½¿ç”¨" class="sidebar-link">socketserverçš„ä½¿ç”¨</a></li></ul></li><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å¤šçº¿ç¨‹" class="sidebar-link">å¤šçº¿ç¨‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#ä½¿ç”¨çº¿ç¨‹å‡½æ•°å’Œçº¿ç¨‹ç±»" class="sidebar-link">ä½¿ç”¨çº¿ç¨‹å‡½æ•°å’Œçº¿ç¨‹ç±»</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—" class="sidebar-link">çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#çº¿ç¨‹é”" class="sidebar-link">çº¿ç¨‹é”</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#æ¡ä»¶å˜é‡" class="sidebar-link">æ¡ä»¶å˜é‡</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#ä¿¡å·é‡" class="sidebar-link">ä¿¡å·é‡</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#çº¿ç¨‹æ± " class="sidebar-link">çº¿ç¨‹æ± </a></li></ul></li><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å¤šè¿›ç¨‹" class="sidebar-link">å¤šè¿›ç¨‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#è¿›ç¨‹æ± " class="sidebar-link">è¿›ç¨‹æ± </a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#è¿›ç¨‹ä¹‹é—´é€šä¿¡" class="sidebar-link">è¿›ç¨‹ä¹‹é—´é€šä¿¡</a></li></ul></li><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å¼‚æ­¥" class="sidebar-link">å¼‚æ­¥</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å¼‚æ­¥åŸºæœ¬æ¦‚å¿µ" class="sidebar-link">å¼‚æ­¥åŸºæœ¬æ¦‚å¿µ</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#ä¸‰ç§å¼‚æ­¥æœºåˆ¶" class="sidebar-link">ä¸‰ç§å¼‚æ­¥æœºåˆ¶</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#asyncioç”Ÿæ€" class="sidebar-link">asyncioç”Ÿæ€</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å°æ€»ç»“" class="sidebar-link">å°æ€»ç»“</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#asyncå…³é”®å­—" class="sidebar-link">asyncå…³é”®å­—</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#åµŒå¥—åç¨‹çš„è¿”å›æœºåˆ¶" class="sidebar-link">åµŒå¥—åç¨‹çš„è¿”å›æœºåˆ¶</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#åœ¨å¼‚æ­¥ä¸­ä½¿ç”¨åŒæ­¥ä»£ç " class="sidebar-link">åœ¨å¼‚æ­¥ä¸­ä½¿ç”¨åŒæ­¥ä»£ç </a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å¼‚æ­¥ç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸€äº›å‡½æ•°" class="sidebar-link">å¼‚æ­¥ç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸€äº›å‡½æ•°</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å¼‚æ­¥ä¸­çš„é”" class="sidebar-link">å¼‚æ­¥ä¸­çš„é”</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#aioå¼‚æ­¥çˆ¬è™«" class="sidebar-link">aioå¼‚æ­¥çˆ¬è™«</a></li><li class="sidebar-sub-header"><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#å¼‚æ­¥æ’å…¥æ•°æ®åº“" class="sidebar-link">å¼‚æ­¥æ’å…¥æ•°æ®åº“</a></li></ul></li><li><a href="/blog/back/python/python%E8%BF%9B%E9%98%B6.html#åç»­å°†æŒç»­æ›´æ–°" class="sidebar-link">åç»­å°†æŒç»­æ›´æ–°</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page" data-v-cdcae5a4> <div class="page-title" data-v-cdcae5a4><h1 data-v-cdcae5a4>pythonè¿›é˜¶</h1> <hr data-v-cdcae5a4> <div data-v-2c25cede data-v-cdcae5a4><i class="iconfont reco-account" data-v-2c25cede><span data-v-2c25cede>ä¼šèµ°è·¯çš„ä¸‰ç™¾å—</span></i> <i class="iconfont reco-date" data-v-2c25cede><span data-v-2c25cede>12/28/2018</span></i> <!----> <i class="iconfont reco-tag tags" data-v-2c25cede><span class="tag-item" data-v-2c25cede>
      è¯­è¨€è¿›é˜¶
    </span><span class="tag-item" data-v-2c25cede>
      å¼‚æ­¥
    </span><span class="tag-item" data-v-2c25cede>
      pythonğŸ
    </span><span class="tag-item" data-v-2c25cede>
      åç«¯
    </span><span class="tag-item" data-v-2c25cede>
      æ‰€æœ‰æ–‡ç« 
    </span></i></div></div> <div class="content" data-v-cdcae5a4><h2 id="pythonä¸­ä¸€åˆ‡çš†å¯¹è±¡"><a href="#pythonä¸­ä¸€åˆ‡çš†å¯¹è±¡" aria-hidden="true" class="header-anchor">#</a> pythonä¸­ä¸€åˆ‡çš†å¯¹è±¡</h2> <h3 id="å¯¹è±¡çš„äº§ç”Ÿ"><a href="#å¯¹è±¡çš„äº§ç”Ÿ" aria-hidden="true" class="header-anchor">#</a> å¯¹è±¡çš„äº§ç”Ÿ</h3> <p>type-&gt;class-&gt;obj <br>
objectæ˜¯æœ€é«˜çš„çˆ¶ç±»ï¼Œæœ¬èº«ç»§æ‰¿None <br></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><pre><code>type
</code></pre> <div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span>
</code></pre></div><pre><code>type
</code></pre> <div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">type</span><span class="token punctuation">.</span>__base__
</code></pre></div><pre><code>object
</code></pre> <p>pythonä¸­çš„å¯¹è±¡æœ‰åŸºæœ¬çš„ä¸‰ä¸ªç‰¹å¾ï¼š</p> <ul><li>idï¼ˆèº«ä»½ï¼‰</li> <li>typeï¼ˆç±»å‹ï¼‰</li> <li>valueï¼ˆå€¼ï¼‰</li></ul> <div class="language-python extra-class"><pre class="language-python"><code>a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</code></pre></div><pre><code>2296013674440
</code></pre> <div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</code></pre></div><pre><code>list
</code></pre> <div class="language-python extra-class"><pre class="language-python"><code>a
</code></pre></div><pre><code>[]
</code></pre> <h3 id="pythonä¸­ä¸åŒçš„ç±»å‹"><a href="#pythonä¸­ä¸åŒçš„ç±»å‹" aria-hidden="true" class="header-anchor">#</a> pythonä¸­ä¸åŒçš„ç±»å‹<br></h3> <div class="warning custom-block"><p class="custom-block-title">1</p> <p>Noneç±»å‹<br></p></div> <p>è§£é‡Šå™¨åˆšå¼€å§‹è¿è¡Œå°±ç”Ÿæˆäº†ä¸€ä¸ªNoneç±»å‹å¯¹è±¡æ‰€æœ‰ç”¨åˆ°äº†Noneçš„åœ°æ–¹æŒ‡å‘çš„éƒ½æ˜¯åŒä¸€ä¸ªå…¨å±€çš„None</p> <div class="language-python extra-class"><pre class="language-python"><code>a<span class="token operator">=</span><span class="token boolean">None</span>
b<span class="token operator">=</span><span class="token boolean">None</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">==</span><span class="token builtin">id</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
c<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
d<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">==</span><span class="token builtin">id</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><pre><code>True
False
</code></pre> <div class="warning custom-block"><p class="custom-block-title">2</p> <p>æ•°å€¼ç±»å‹ å››ç§<br>
int float bool complex</p></div> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>
<span class="token builtin">type</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token builtin">type</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token builtin">type</span><span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">complex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><pre><code>&lt;class 'int'&gt; &lt;class 'float'&gt; &lt;class 'bool'&gt; &lt;class 'complex'&gt;
</code></pre> <div class="warning custom-block"><p class="custom-block-title">3</p> <p>è¿­ä»£ç±»å‹</p></div> <p>å¯ç”¨forè¿­ä»£çš„å¯¹è±¡
å®ç°äº†iteræ–¹æ³•æˆ–è€…getitemæ–¹æ³•çš„å¯¹è±¡</p> <div class="warning custom-block"><p class="custom-block-title">4</p> <p>åºåˆ—ç±»å‹</p></div> <p>list<br>tuple<br> arry <br>str<br> range<br> bytes <br>bytearry <br> memoryview(äºŒè¿›åˆ¶åºåˆ—)    <br></p> <h4 id="å…¶ä»–ç±»å‹"><a href="#å…¶ä»–ç±»å‹" aria-hidden="true" class="header-anchor">#</a> å…¶ä»–ç±»å‹</h4> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>5 æ˜ å°„ç±»å‹ k-v å­—å…¸ï¼Œquerysetç­‰    <br>
6 é›†åˆç±»å‹set frozenset ï¼Œsetå’Œæ˜ å°„ç±»å‹åº•å±‚å®ç°ä¸€è‡´æ•ˆç‡è¾ƒé«˜    <br>
7 ä¸Šä¸‹æ–‡ç®¡ç†ç±»å‹ with è¯­å¥æ‰€å½¢æˆçš„ç±»å‹    8 æ¨¡å—ç±»å‹ï¼ˆpackageä¹Ÿæ˜¯ä¸€ç§ç±»å‹ï¼‰    <br>
9 classå’Œå®ä¾‹ç±»å‹    <br>
10 å‡½æ•°ç±»å‹    <br>
11 æ–¹æ³•ç±»å‹    <br>
12 ä»£ç ç±»å‹ï¼ˆä»£ç æœ¬èº«ä¹Ÿä¼šè¢«è§£é‡Šä¸ºä¸€ç§ç±»å‹ï¼ï¼ï¼ï¼‰   <br>
13 objectå¯¹è±¡    <br>
14 typeç±»å‹  <br>
15 ellipsisç±»å‹çœç•¥å·ç±»å‹ï¼Ÿï¼    <br>
16 notimplementedç±»å‹å°±æ˜¯ç±»å¯¹è±¡<br></p></div> <h2 id="é­”æ³•å‡½æ•°"><a href="#é­”æ³•å‡½æ•°" aria-hidden="true" class="header-anchor">#</a> é­”æ³•å‡½æ•°</h2> <p>ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´ç»“å°¾ï¼Œå…·æœ‰ç‰¹æ®ŠåŠŸèƒ½çš„å‡½æ•° ä¸€èˆ¬ä¸è¦å»è‡ªå·±å®šä¹‰ï¼Œé‡è½½pythonæä¾›ç»™æˆ‘ä»¬çš„å³å¯<br></p> <p>pythonçš„æ•°æ®æ¨¡å‹æ˜¯pythonåº•å±‚å®ç°æœºåˆ¶é‡è¦çš„ä¸€ç¯æˆ‘ä»¬å¯ä»¥é€šè¿‡é‡è½½è¿™äº›é­”æ³•å‡½æ•°æ¥å®ç°è‡ªå·±æƒ³è¦çš„åŠŸèƒ½<br></p> <p>å…ˆåˆ—å‡ºä¸»è¦çš„é­”æ³•å‡½æ•°<br></p> <h3 id="éæ•°å­¦è¿ç®—ç±»"><a href="#éæ•°å­¦è¿ç®—ç±»" aria-hidden="true" class="header-anchor">#</a> éæ•°å­¦è¿ç®—ç±»<br></h3> <pre><code>å­—ç¬¦ä¸²è¡¨ç¤ºï¼š
    __repr__():

    __str__():

é›†åˆåºåˆ—ç›¸å…³ï¼š
	__len__():
	__getitem__():
	__setitem__():
	__delitem__():
	__contains__():
è¿­ä»£ç›¸å…³:
	__iter__():
	__next__():
å¯è°ƒç”¨
	__call__():
withä¸Šä¸‹æ–‡ç®¡ç†å™¨
	__enter__():
	__exit__():
æ•°å€¼è½¬æ¢
	__abs__():
	__bool__():
	__int__():
	__float__():
    __hash__():
    __index__():
å…ƒç±»ç›¸å…³
    __new__():
    __init__():
å±æ€§ç›¸å…³
	__getattr__():
	__setattr__():
	__getattribute__():
	__setattribute__():
	__dir__():
å±æ€§æè¿°ç¬¦
	__get__():
	__set__():
	__delete__():
åç¨‹
	__await__():
    __aiter__():
    __anext__():
    __aenter__():
    __aexit__():
</code></pre> <h3 id="æ•°å­¦è¿ç®—ç±»"><a href="#æ•°å­¦è¿ç®—ç±»" aria-hidden="true" class="header-anchor">#</a> æ•°å­¦è¿ç®—ç±»</h3> <h4 id="ç•¥"><a href="#ç•¥" aria-hidden="true" class="header-anchor">#</a> ç•¥</h4> <h3 id="str-å’Œ-repr"><a href="#str-å’Œ-repr" aria-hidden="true" class="header-anchor">#</a> str å’Œ repr</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">company</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>em<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>em<span class="token operator">=</span>em

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;employee:&quot;</span> <span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>em<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;å¼€å‘è€…æ¨¡å¼ä¸‹ä¸ç”¨æ‰“å°å°±å¯ä»¥è°ƒç”¨&quot;</span>

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>em<span class="token punctuation">)</span>
em<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;bobby&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;tom&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;bob&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;jhon&quot;</span><span class="token punctuation">]</span>
com<span class="token operator">=</span>company<span class="token punctuation">(</span>em<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>com<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;lençš„ç”¨æ³•: &quot;</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>com<span class="token punctuation">)</span><span class="token punctuation">)</span>
com
</code></pre></div><pre><code>employee:bobby,tom,bob,jhon
lençš„ç”¨æ³•:  4

å¼€å‘è€…æ¨¡å¼ä¸‹ä¸ç”¨æ‰“å°å°±å¯ä»¥è°ƒç”¨
</code></pre> <h4 id="str-self"><a href="#str-self" aria-hidden="true" class="header-anchor">#</a> _ <em>str</em> _(self):</h4> <p>åœ¨ç›´æ¥æ‰“å°è¿™ä¸ªå¯¹è±¡æ—¶å°±ä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œè‹¥æ²¡æœ‰å®šä¹‰åˆ™ä¼šæ‰“å°ä¸€äº›åŸºæœ¬å±æ€§</p> <h4 id="repr-self"><a href="#repr-self" aria-hidden="true" class="header-anchor">#</a> _ <em>repr</em> _(self):</h4> <p>åœ¨å¼€å‘è€…æ¨¡å¼ä¸­ç›´æ¥è°ƒç”¨è¿™ä¸ªå¯¹è±¡åˆ™ä¼šè°ƒç”¨repræ–¹æ³•<br>pythonå†…ç½®çš„æ•°æ®ç±»å‹æ˜¯ç”¨Cpythonå®ç°çš„ï¼Œå†…ç½®æ–¹æ³•æ˜¯Cè¯­è¨€å®ç°çš„æ•ˆç‡ä¼šå¾ˆé«˜<br>
ä¾‹å¦‚_ <em>len</em> _æ–¹æ³•æ˜¯åœ¨æ•°æ®ç»“æ„å†…ç»´æŠ¤ä¸€ä¸ªé•¿åº¦ï¼Œè°ƒç”¨lençš„æ—¶å€™ç›´æ¥ä»å†…å­˜è¯»å–ä¼šå¿«å¾ˆå¤š<br>
for å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œéå†çš„æ—¶å€™ä¼šå…ˆå¯»æ‰¾iteræ–¹æ³•ï¼Œæ‰¾ä¸åˆ°ä¼šè‡ªåŠ¨å¯»æ‰¾getitemæ–¹æ³•<br></p> <h2 id="é¸­å­ç±»å‹å’Œpythonçš„å¤šæ€æ€§"><a href="#é¸­å­ç±»å‹å’Œpythonçš„å¤šæ€æ€§" aria-hidden="true" class="header-anchor">#</a> é¸­å­ç±»å‹å’Œpythonçš„å¤šæ€æ€§ <br></h2> <h3 id="ä»€ä¹ˆæ˜¯é¸­å­"><a href="#ä»€ä¹ˆæ˜¯é¸­å­" aria-hidden="true" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯é¸­å­</h3> <p>èµ°è·¯åƒé¸­å­å«å£°åƒé¸­å­é•¿å¾—åƒé¸­å­ é‚£ä¹ˆå°±æ˜¯é¸­å­ã€‚<br>
åªè¦å¯¹è±¡æ‹¥æœ‰è¿™ä¸ªç‰¹æ€§é‚£å°±æ˜¯è¿™ä¸ªç±»å‹å°±å¯ä»¥è°ƒç”¨ç›¸å…³çš„æ–¹æ³•</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">say</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;hahaha...&quot;</span><span class="token punctuation">)</span>



<span class="token keyword">class</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">say</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;15551&quot;</span><span class="token punctuation">)</span>

l<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
l<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Dog<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
l<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Cat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>
    i<span class="token punctuation">.</span>say<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><pre><code>15551
hahaha...
</code></pre> <p>ä¸åŒç±»å‹çš„å¯¹è±¡åªè¦æ‹¥æœ‰ç›¸åŒåå­—çš„æ–¹æ³•å°±å¯ä»¥è°ƒç”¨,ä¼ å…¥å¯¹è±¡çš„å¥æŸ„(åå­—)å³å¯</p> <div class="language-python extra-class"><pre class="language-python"><code>li<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
se<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>

li<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>se<span class="token punctuation">)</span>
li
</code></pre></div><pre><code>[1, 2, 3, 4]
</code></pre> <p>åªè¦æ˜¯ç›¸åŒçš„åŸºç¡€æ•°æ®ç±»å‹ï¼ˆè¿­ä»£ç±»å‹ï¼Œåºåˆ—ç±»å‹ï¼‰æ–¹æ³•å¯ä»¥æ··ç”¨<br>
_ <em>getitem</em> _ï¼šæ ¹æ®ä¼ å…¥çš„intå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨ä¸­çš„å…ƒç´ </p> <p>_ <em>iter</em> _ï¼šè¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡</p> <p>_ <em>next</em> _ï¼šå½“è¢«è¿­ä»£æ—¶ï¼Œè¿”å›ä¸‹ä¸€ä¸ªè¿­ä»£çš„å¯¹è±¡</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;it is string&quot;</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">yield</span> self<span class="token punctuation">.</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span>


test<span class="token operator">=</span>Test<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>test<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> x <span class="token keyword">in</span> test<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">#å’Œä¸‹é¢æ˜¯ç­‰ä»·çš„ï¼Œä¸è¿‡__iter__æ˜¯è¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œè€Œiter()ç›´æ¥æŠŠè¿™è¿™ä¸ªå¯è¿­ä»£å¯¹è±¡æ‹¿å‡ºæ¥è½¬æ¢</span>
test1<span class="token operator">=</span><span class="token builtin">iter</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>test1<span class="token punctuation">)</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>test1<span class="token punctuation">)</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>test1<span class="token punctuation">)</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>test1<span class="token punctuation">)</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>test1<span class="token punctuation">)</span>

</code></pre></div><pre><code>i
it
it
it i
it is
it is
it is s
it is st
it is str
1
2
3
4



---------------------------------------------------------------------------

StopIteration                             Traceback (most recent call last)

&lt;ipython-input-52-1fe123b9197d&gt; in &lt;module&gt;()
     23 next(test1)
     24 next(test1)
---&gt; 25 next(test1)


StopIteration:
</code></pre> <p>next(x)=x.<strong>next</strong>,å…³äºè¿­ä»£æœ‰ä¸¤ä¸ªæ¦‚å¿µ
<br>ç¬¬ä¸€ä¸ªæ˜¯Iterable(å¯è¿­ä»£å¯¹è±¡)
<br>ç¬¬äºŒä¸ªæ˜¯Iteratorï¼ˆè¿­ä»£å™¨ï¼‰<br>
åè®®è§„å®šIterableçš„__iter__æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªIterator,<br>
Iteratorçš„__next__æ–¹æ³•ä¼šè¿”å›ä¸‹ä¸€ä¸ªè¿­ä»£å¯¹è±¡ï¼Œå¦‚æœè¿­ä»£ç»“æŸåˆ™æŠ›å‡ºStopIterationå¼‚å¸¸ã€‚<br>iter(itr, 'c')  è¿™ä¸ªæ„æ€æ˜¯è¯´ï¼Œè¿”å›itrçš„iteratorï¼Œè€Œä¸”åœ¨ä¹‹åçš„è¿­ä»£ä¹‹ä¸­ï¼Œè¿­ä»£å‡ºæ¥'c'å°±ç«‹é©¬åœæ­¢ã€‚<br>å¯¹è¿™ä¸ªitræœ‰ä»€ä¹ˆè¦æ±‚å‘¢ï¼Ÿè¿™ä¸ªitråœ¨è¿™é‡Œå¿…é¡»æ˜¯callableçš„ï¼Œå³è¦<br>å®ç°__call__å‡½æ•°å®šä¹‰äº†__getitem__æ–¹æ³•ä¹‹åè¯¥å¯¹è±¡å°±å¯ä»¥è¢«ä¸‹æ ‡å’Œåˆ‡ç‰‡</p> <h3 id="æŠ½è±¡åŸºç±»"><a href="#æŠ½è±¡åŸºç±»" aria-hidden="true" class="header-anchor">#</a> æŠ½è±¡åŸºç±»</h3> <p><a href="https://blog.csdn.net/qijiqiguai/article/details/77269839">ä¸€ä¸ªåšä¸»çš„è¯¦ç»†ä»‹ç»</a>
ABCï¼ŒAbstract Base Classï¼ˆæŠ½è±¡åŸºç±»ï¼‰ï¼Œä¸»è¦å®šä¹‰äº†åŸºæœ¬ç±»å’Œæœ€åŸºæœ¬çš„æŠ½è±¡æ–¹æ³•ï¼Œå¯ä»¥ä¸ºå­ç±»å®šä¹‰å…±æœ‰çš„APIï¼Œä¸éœ€è¦å…·ä½“å®ç°ã€‚ç›¸å½“äºæ˜¯Javaä¸­çš„æ¥å£æˆ–è€…æ˜¯æŠ½è±¡ç±»ã€‚</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">company</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>l<span class="token operator">=</span>l

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">5</span>

<span class="token keyword">from</span> collections <span class="token keyword">import</span> Sized
<span class="token comment">#å¯¹è±¡æ˜¯å¦æœ‰é•¿åº¦</span>
<span class="token builtin">isinstance</span><span class="token punctuation">(</span>company<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sized<span class="token punctuation">)</span>
<span class="token comment">#å¯¹è±¡æ˜¯å¦æœ‰æŸä¸ªå±æ€§ï¼Œä¼ å…¥çš„æ˜¯å¥æŸ„</span>
<span class="token builtin">hasattr</span><span class="token punctuation">(</span>company<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;__len__&quot;</span><span class="token punctuation">)</span>
</code></pre></div><pre><code>True
</code></pre> <p>å®ç°ä¸€ä¸ªæŠ½è±¡åŸºç±»æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯åœ¨è¦åšåŸºç±»çš„ç±»æ–¹æ³•ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œä½¿å…¶å¿…é¡»é‡å†™è¿™ä¸ªæ–¹æ³•</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">AbstractBase</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> NotImplementError

    <span class="token keyword">def</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> NotImplementError

<span class="token comment">#æ›´ä¼˜é›…ä¸€äº›çš„æ–¹æ³•</span>
<span class="token keyword">import</span> abc<span class="token comment">#è‡ªå¸¦çš„abcï¼Œå¯ä»¥åšè£…é¥°å™¨ç”¨</span>
<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>abc<span class="token punctuation">.</span>ABCMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    @abc<span class="token punctuation">.</span>abstractmethod
    <span class="token keyword">def</span> <span class="token function">my</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
A<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><pre><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

&lt;ipython-input-59-dc359d224db9&gt; in &lt;module&gt;()
     12     def my(self):
     13         pass
---&gt; 14 A()


TypeError: Can't instantiate abstract class A with abstract methods my
</code></pre> <div class="danger custom-block"><p class="custom-block-title">å…¶å®æœ‰ä¸€ç‚¹ä¸å¤ªæ˜ç™½ ç•™å‘</p> <p>abcä¸­å¼ºåˆ¶è§„å®šäº†abstractmethodï¼Œç»§æ‰¿æ—¶è‹¥ä¸å®ç°è¿™ä¸€æ–¹æ³•å°±æ— æ³•å®ä¾‹åŒ–<br>
from collections.abc import *<br>
å·²ç»åšå¥½çš„ä¸€äº›åŸºç±»å¯ä»¥æ‹¿æ¥ç»§æ‰¿<br>
å®ç°äº†__subclasshook__ç”¨äºç±»å‹åˆ¤æ–­<br></p></div> <p>pythonçš„é¸­å­ç±»å‹æ˜¯æ ¹æœ¬,æŠ½è±¡åŸºç±»å¯ä»¥ç»™æˆ‘ä»¬æä¾›ä¸€äº›æ¥å£çš„å¼ºåˆ¶è§„å®šå’Œå¸®åŠ©æˆ‘ä»¬è‡ªå®šä¹‰ç±»å‹ç­‰ç­‰</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>


<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>


b<span class="token operator">=</span>B<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token builtin">isinstance</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>A<span class="token punctuation">)</span>
</code></pre></div><pre><code>True
</code></pre> <div class="danger custom-block"><p class="custom-block-title">is å’Œ ==ä¸èƒ½æ··ç”¨</p> <p>isæ˜¯åˆ¤æ–­æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡é€šè¿‡id()çš„æŒ‡å‘ï¼Œè€Œç›¸ç­‰æ˜¯åˆ¤æ–­å€¼ç›¸ç­‰<br>isinstanceåˆ¤æ–­å¯¹è±¡æ˜¯å¦åœ¨ç»§æ‰¿é“¾çš„ç±»å‹ä¸­</p></div> <h3 id="åŠŸèƒ½ç±»mixinå’Œå˜é‡æœºåˆ¶"><a href="#åŠŸèƒ½ç±»mixinå’Œå˜é‡æœºåˆ¶" aria-hidden="true" class="header-anchor">#</a> åŠŸèƒ½ç±»MixInå’Œå˜é‡æœºåˆ¶</h3> <p>åŠŸèƒ½ç±»ï¼Œä»¥MixInå‘½åç»“å°¾å¤šç»§æ‰¿å…³ç³»ä¸­ä½œä¸ºåŠŸèƒ½ç±»ç»§æ‰¿ï¼Œè®¾è®¡å®ç°å•ä¸€åŠŸèƒ½ï¼Œç›¸å½“äºä»£æ›¿æ¥å£<br>
Mixinçš„ç‰¹ç‚¹<br>
å’ŒåŸºç±»æ˜¯å¼±ç›¸å…³æˆ–ä¸ç›¸å…³<br>
MixinåŠŸèƒ½å•ä¸€<br>
ä¸è¦ä½¿ç”¨Mixinçš„super<br></p> <h4 id="ç±»å˜é‡å’Œå¯¹è±¡å˜é‡"><a href="#ç±»å˜é‡å’Œå¯¹è±¡å˜é‡" aria-hidden="true" class="header-anchor">#</a> ç±»å˜é‡å’Œå¯¹è±¡å˜é‡</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    aa<span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#self å®åœ¨å®ä¾‹åŒ–çš„æ—¶å€™ä¼ é€’è¿›æ¥çš„å®ä¾‹æœ¬èº«</span>
        self<span class="token punctuation">.</span>x<span class="token operator">=</span>x
        self<span class="token punctuation">.</span>y<span class="token operator">=</span>y

a<span class="token operator">=</span>A<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span>aa<span class="token operator">=</span><span class="token number">100</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>aa<span class="token punctuation">,</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>aa<span class="token punctuation">)</span>
</code></pre></div><pre><code>100 2 3
1
</code></pre> <p>å†è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šé¦–å…ˆæŸ¥æ‰¾å®ä¾‹å˜é‡å†å»æŸ¥æ‰¾ç±»å˜é‡<br>
åœ¨æ²¡æœ‰åˆå§‹åŒ–açš„æ—¶å€™å­˜åœ¨ä¸€ä¸ªAçš„ç±»æ˜¯ä¸€ä¸ªç±»å¯¹è±¡,å®ä¾‹åŒ–çš„æ—¶å€™æˆä¸ºä¸€ä¸ªç±»å¯¹è±¡çš„å®ä¾‹<br>
å¯¹ç±»å®ä¾‹è¿›è¡Œèµ‹å€¼ï¼Œä¼šå½±å“åç»­ç±»å¯¹è±¡ï¼Œå¯¹ç±»å¯¹è±¡è¿›è¡Œèµ‹å€¼ï¼Œåˆ™åªä¼šå½±å“æœ¬ç±»å¯¹è±¡<br>
python3ä¸­ä½¿ç”¨C3ç®—æ³•è§£å†³<a href="https://www.cnblogs.com/chenyoude/p/9857308.html">è±å½¢ç»§æ‰¿</a><br></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>y<span class="token punctuation">,</span>m<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>year<span class="token operator">=</span>y
        self<span class="token punctuation">.</span>month<span class="token operator">=</span>m
        self<span class="token punctuation">.</span>day<span class="token operator">=</span>d

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">r&quot;{0}/{1}/{2}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>year<span class="token punctuation">,</span>self<span class="token punctuation">.</span>month<span class="token punctuation">,</span>self<span class="token punctuation">.</span>day<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">tomorrow</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>day<span class="token operator">+=</span><span class="token number">1</span>


date<span class="token operator">=</span>Date<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span>
date<span class="token punctuation">.</span>tomorrow<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span>
</code></pre></div><pre><code>2018/3/4
2018/3/5
</code></pre> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>è°ƒç”¨date.tomorrow()ç›¸å½“äºtomorrowï¼ˆdateï¼‰<br>åªä¼šæ”¹å˜å½“å‰å¯¹è±¡çš„å±æ€§ï¼Œç±»å±æ€§åº”è¯¥å†™æˆDate.day+=1</p></div> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>y<span class="token punctuation">,</span>m<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>year<span class="token operator">=</span>y
        self<span class="token punctuation">.</span>month<span class="token operator">=</span>m
        self<span class="token punctuation">.</span>day<span class="token operator">=</span>d

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">r&quot;{0}-{1}-{2}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>year<span class="token punctuation">,</span>self<span class="token punctuation">.</span>month<span class="token punctuation">,</span>self<span class="token punctuation">.</span>day<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">tomorrow</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>day<span class="token operator">+=</span><span class="token number">1</span>

    @<span class="token builtin">staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">vaild</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">:</span>
        temp<span class="token operator">=</span>string<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;valited&quot;</span><span class="token punctuation">)</span>

    @<span class="token builtin">classmethod</span>
    <span class="token keyword">def</span> <span class="token function">dformat</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span>string<span class="token punctuation">)</span><span class="token punctuation">:</span>
        temp<span class="token operator">=</span>string<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">(</span>temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>temp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>temp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


date<span class="token operator">=</span>Date<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
string<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span>dformat<span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><pre><code>2018-3-4
</code></pre> <h3 id="ç±»æ–¹æ³•å’Œé™æ€æ–¹æ³•"><a href="#ç±»æ–¹æ³•å’Œé™æ€æ–¹æ³•" aria-hidden="true" class="header-anchor">#</a> ç±»æ–¹æ³•å’Œé™æ€æ–¹æ³•<br></h3> <p>é™æ€æ–¹æ³•ä¸€èˆ¬æ˜¯ç”¨æ¥éªŒè¯æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œä¸ç”¨å†æ–°å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè€Œç±»æ–¹æ³•å¯ä»¥ç›´æ¥è¿”å›å®ä¾‹å¯¹è±¡</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    birthday<span class="token operator">=</span><span class="token number">1995</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>birthday<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>birthday<span class="token operator">=</span>birthday


<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>Date<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">2018</span><span class="token operator">-</span><span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>birthday

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>age<span class="token punctuation">)</span>


user<span class="token operator">=</span>User<span class="token punctuation">(</span><span class="token punctuation">)</span>
user
<span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>__dict__<span class="token punctuation">,</span>User<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>
</code></pre></div><pre><code>{'age': 23} {'__module__': '__main__', '__init__': &lt;function User.__init__ at 0x0000025EDB51DE18&gt;, '__repr__': &lt;function User.__repr__ at 0x0000025EDB5606A8&gt;, '__doc__': None}
</code></pre> <h3 id="è‡ªçœæœºåˆ¶"><a href="#è‡ªçœæœºåˆ¶" aria-hidden="true" class="header-anchor">#</a> è‡ªçœæœºåˆ¶</h3> <p>__atträ¸èƒ½ç›´æ¥è®¿é—®ï¼Œç›¸å½“äºprivateï¼Œä½†ä¹Ÿå¯_class__attræ¥è®¿é—®<br>
__dict__å¯ä»¥ç›´æ¥ä¸‹æ ‡è®¿é—®æ˜¯å­˜è´®å±æ€§çš„å­—å…¸ï¼Œä¹Ÿå¯ä»¥åŠ¨æ€ä¿®æ”¹<br>
dirä¼šæŠŠæ‰€æœ‰çš„å±æ€§ç‰¹æœ‰çš„å’ŒåŸºç¡€çš„å®Œæ•´çš„åˆ—å‡ºæ¥<br>
superå‡½æ•°æ˜¯æŒ‰ç…§__mro__é¡ºåºæ¥è°ƒç”¨çš„ï¼ŒBFSï¼Œå¦‚æœsuperæœ‰ç¼ºçœå¯ä»¥ç›´æ¥è®©çˆ¶ç±»çš„æ„é€ å‡½æ•°æ¥å®Œæˆåˆå§‹åŒ–<br>
Mixinçš„ç‰¹ç‚¹<br>
å’ŒåŸºç±»æ˜¯å¼±ç›¸å…³æˆ–ä¸ç›¸å…³<br>
MixinåŠŸèƒ½å•ä¸€<br></p> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>ä¸è¦ä½¿ç”¨Mixinçš„super<br></p></div> <div class="danger custom-block"><p class="custom-block-title">Tryçš„å †æ ˆ</p> <p>pythonçš„try exceptå’Œfinallyè¯­å¥çš„returnæ‰§è¡Œåˆ°error æ—¶è¿›å…¥except æ ˆé¡¶push ä¸€ä¸ªå€¼ï¼Œä¸è¿”å›ï¼Œå…ˆè¿è¡Œfinallyè¯­å¥å†ä»æ ˆé¡¶æ‹¿å‡ºä¸€ä¸ªå€¼pop</p></div> <h2 id="åŸºäºåè®®çš„python"><a href="#åŸºäºåè®®çš„python" aria-hidden="true" class="header-anchor">#</a> åŸºäºåè®®çš„python</h2> <h3 id="ä¸Šä¸‹æ–‡ç®¡ç†åè®®"><a href="#ä¸Šä¸‹æ–‡ç®¡ç†åè®®" aria-hidden="true" class="header-anchor">#</a> ä¸Šä¸‹æ–‡ç®¡ç†åè®®</h3> <p>pythonæ˜¯åŸºäºåè®®çš„è¿è¡Œ,é¦–å…ˆä»‹ç»ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„åè®®
ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»å¸¸ç”¨çš„with</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Sample</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    S<span class="token operator">=</span><span class="token string">&quot;å±±å£å±±&quot;</span>
    <span class="token keyword">def</span> <span class="token function">hah</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;aa&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>exc_type<span class="token punctuation">,</span>exc_val<span class="token punctuation">,</span>exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">)</span>

    @<span class="token builtin">classmethod</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">gett</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> Sample<span class="token punctuation">(</span><span class="token punctuation">)</span>

a<span class="token operator">=</span>Sample<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># a.__dict__</span>
<span class="token comment"># dir(a)</span>
<span class="token keyword">with</span> gett<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sample<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>sample<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token builtin">dir</span><span class="token punctuation">(</span>sample<span class="token punctuation">)</span>
    sample<span class="token punctuation">.</span>hah<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sample<span class="token punctuation">.</span>S<span class="token punctuation">)</span>
</code></pre></div><pre><code>start
&lt;class 'NoneType'&gt;
end



---------------------------------------------------------------------------

AttributeError                            Traceback (most recent call last)

&lt;ipython-input-172-7d068effdd73&gt; in &lt;module&gt;()
     23     print(type(sample))
     24     dir(sample)
---&gt; 25     sample.hah()
     26     print(sample.S)


AttributeError: 'NoneType' object has no attribute 'hah'
</code></pre> <p>å…·ä½“å¯æ§çš„ä¸Šä¸‹æ–‡ç®¡ç†åè®®</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> contextlib

@contextlib<span class="token punctuation">.</span>contextmanager
<span class="token keyword">def</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å‰æ“ä½œ&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">yield</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;åæ“ä½œ&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> p<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> pp<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸­é—´çš„æ“ä½œ&quot;</span><span class="token punctuation">)</span>
</code></pre></div><pre><code>å‰æ“ä½œ
ä¸­é—´çš„æ“ä½œ
åæ“ä½œ
</code></pre> <h3 id="åºåˆ—ç›¸å…³åè®®"><a href="#åºåˆ—ç›¸å…³åè®®" aria-hidden="true" class="header-anchor">#</a> åºåˆ—ç›¸å…³åè®®</h3> <p>åºåˆ— <br>å®¹å™¨åºåˆ— <br>æ‰å¹³åºåˆ— <br>å¯å˜/ä¸å¯å˜<br>
åœ¨ collections abcä¸­æœ‰ä¸¤ä¸ªæŠ½è±¡åŸºç±»:<br> Squence MutableSequenceåºåˆ—å’Œå¤šå¯¹è±¡åºåˆ—<br></p> <p>Sequenceåºåˆ—ç±»ç»§æ‰¿äº†<br>{
Â Â Â Â Reversibleå¯åè½¬ï¼Œ<br>
Â Â Â Â Collectionç»§æ‰¿äº†{<br>
Â Â Â Â Â Â Â Â Sizedé•¿åº¦<br>
Â Â Â Â Â Â Â Â Iterableå¯è¿­ä»£<br>
Â Â Â Â Â Â Â Â Containerå®¹å™¨{<br>
Â Â Â Â Â Â Â Â Â Â Â çš„absctactmethod <strong>contains__è´Ÿè´£isä»¥ä»¥åŠ__setitem</strong> <strong>delitem</strong>}}}}</p> <h4 id="åœ¨åºåˆ—ä¸­-extendçš„åŒºåˆ«"><a href="#åœ¨åºåˆ—ä¸­-extendçš„åŒºåˆ«" aria-hidden="true" class="header-anchor">#</a> åœ¨åºåˆ—ä¸­+ += extendçš„åŒºåˆ«</h4> <div class="language-python extra-class"><pre class="language-python"><code>a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
c<span class="token operator">=</span>a<span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
c<span class="token operator">+=</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span>
c
</code></pre></div><pre><code>[1, 2, 3, 4, 5, 6]
</code></pre> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>+=å®é™…ä¸Šæ—¶abcä¸­çš„__iadd__è°ƒç”¨çš„æ—¶extend -&gt;æ‰§è¡Œfor å¾ªç¯ä¸€ä¸ªä¸ªappendåˆ°åºåˆ—ä¸­<br>æ‰€ä»¥å¯ä»¥æ¥å—ä¸€ä¸ªåºåˆ—å³å¯ï¼Œåœ¨åŸåºåˆ—ä¸­ç›´æ¥åŠ <br>è€Œ+æ˜¯äº§ç”Ÿä¸€ä¸ªæ–°çš„åºåˆ—
<br>åˆ‡ç‰‡æ“ä½œæ˜¯ä¼šè¿”å›ä¸€ä¸ªæ–°çš„åˆ—è¡¨</p></div> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Group</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>groupname<span class="token punctuation">,</span>companyname<span class="token punctuation">,</span>member<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>group_name <span class="token operator">=</span> groupname
        self<span class="token punctuation">.</span>company <span class="token operator">=</span> companyname
        self<span class="token punctuation">.</span>member <span class="token operator">=</span> member
    <span class="token keyword">def</span> <span class="token function">__reversed__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span><span class="token comment">#è‡ªè¡Œè§£å†³</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cls<span class="token operator">=</span><span class="token builtin">type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span> <span class="token punctuation">(</span>item<span class="token punctuation">,</span><span class="token builtin">slice</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> cls<span class="token punctuation">(</span>group_name<span class="token operator">=</span>self<span class="token punctuation">.</span>group_name<span class="token punctuation">,</span>companyname<span class="token operator">=</span>self<span class="token punctuation">.</span>company<span class="token punctuation">,</span>member<span class="token operator">=</span>self<span class="token punctuation">.</span>member<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>numbers<span class="token punctuation">.</span>Integral<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> cls<span class="token punctuation">(</span>group_name<span class="token operator">=</span>self<span class="token punctuation">.</span>group_name<span class="token punctuation">,</span>companyname<span class="token operator">=</span>self<span class="token punctuation">.</span>company<span class="token punctuation">,</span>member<span class="token operator">=</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>member<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment">#åˆ‡ç‰‡sliceå¯¹è±¡å’Œitemæ˜¯é‡ç‚¹</span>

    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span><span class="token comment">#è‡ªè¡Œè§£å†³</span>

    <span class="token keyword">def</span> <span class="token function">__contains__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>member<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token comment"># ç”¨if æ¥è§£å†³ in</span>
</code></pre></div><h4 id="ç»´æŠ¤ä¸€ä¸ªå·²æ’åºçš„åºåˆ—"><a href="#ç»´æŠ¤ä¸€ä¸ªå·²æ’åºçš„åºåˆ—" aria-hidden="true" class="header-anchor">#</a> ç»´æŠ¤ä¸€ä¸ªå·²æ’åºçš„åºåˆ—</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> bisect

<span class="token comment">#your class&amp;function here</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    l<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    bisect<span class="token punctuation">.</span>insort<span class="token punctuation">(</span>l<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    bisect<span class="token punctuation">.</span>insort<span class="token punctuation">(</span>l<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    bisect<span class="token punctuation">.</span>insort<span class="token punctuation">(</span>l<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
    bisect<span class="token punctuation">.</span>insort<span class="token punctuation">(</span>l<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
    bisect<span class="token punctuation">.</span>insort<span class="token punctuation">(</span>l<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>
    bisect<span class="token punctuation">.</span>insort_left<span class="token punctuation">(</span>l<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
    bisect<span class="token punctuation">.</span>insort_right<span class="token punctuation">(</span>l<span class="token punctuation">,</span><span class="token number">2.9</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>
</code></pre></div><pre><code>[1, 2, 3, 5, 6]
[1, 2, 2.9, 3, 5, 5, 6]
</code></pre> <p>arrç•™å‘</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> arry
<span class="token keyword">from</span> collections <span class="token keyword">import</span> deque

</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>åˆ—è¡¨ç”Ÿæˆå¼æ€§èƒ½æ˜¯é«˜äºåˆ—è¡¨æ™®é€šæ“ä½œçš„ï¼Œå¯ä»¥ç”¨å‡½æ•°æ¥è¿›è¡Œæ“ä½œ</p></div> <div class="language-python extra-class"><pre class="language-python"><code>    <span class="token keyword">def</span> <span class="token function">x</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span>y<span class="token comment">#è¿”å›å€¼ä¼šè¢«æ·»åŠ è¿›åˆ—è¡¨ä¸­</span>
    l<span class="token operator">=</span><span class="token punctuation">[</span>x<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> l <span class="token keyword">if</span> i <span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span>
    l1<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> l <span class="token keyword">if</span> i <span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>l1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#ç”Ÿæˆå™¨è¡¨è¾¾å¼</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>l1<span class="token punctuation">)</span>
    dic<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">:</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">:</span><span class="token number">88</span><span class="token punctuation">}</span>
    reverseddic<span class="token operator">=</span><span class="token punctuation">{</span>v<span class="token punctuation">:</span>k <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>reverseddic<span class="token punctuation">)</span><span class="token comment">#é”®å€¼å¯¹åè½¬</span>
</code></pre></div><h3 id="mappingç±»å‹åè®®"><a href="#mappingç±»å‹åè®®" aria-hidden="true" class="header-anchor">#</a> Mappingç±»å‹åè®®</h3> <h4 id="dict"><a href="#dict" aria-hidden="true" class="header-anchor">#</a> dict</h4> <p>dictæ˜¯ä¸€ä¸ªå…¸å‹Mappingç±»å‹ï¼Œabcç»§æ‰¿å…³ç³»æ˜¯<br>
-Container as Container,<br>
-Hashable as Hashable,<br>
-Iterable as Iterable,<br>
Iterator as Iterator,<br>
-Sized as Sized,<br>
Callable as Callable,<br>
-Mapping as Mapping,<br>
MutableMapping as MutableMapping,<br>
Sequence as Sequence,<br>
MutableSequence as MutableSequence,<br>
Set as Set,<br>
MutableSet as MutableSet,<br>
MappingView as MappingView,<br>
ItemsView as ItemsView,<br>
KeysView as KeysView,<br>
ValuesView as ValuesView,<br></p> <div class="warning custom-block"><p class="custom-block-title">copy</p> <p>æ·±æ‹·è´æ”¹å˜æ‹·è´å¯¹è±¡ä¸ä¼šæ”¹å˜åŸå¯¹è±¡ï¼Œåªè¦æ‹·è´çš„å¯¹è±¡æ˜¯éå®¹å™¨ç±»å‹ï¼ˆæ¯”å¦‚å­—ç¬¦ä¸²ï¼Œæ•°å­—å’Œå…¶ä»–åŸå­ç±»å‹ï¼‰å°±ä¸èƒ½è¿›è¡Œæ‹·è´è€Œæ˜¯æ·»åŠ å¼•ç”¨</p></div> <p>è¿™æ˜¯ä»£ç </p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> copy
a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
b<span class="token operator">=</span>a
c<span class="token operator">=</span>a<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æµ…æ‹·è´,å¤åˆ¶äº†ä¸€ä¸ªå…¶ä»–å¯¹è±¡ï¼Œä½†æ˜¯ä¸ä¼šæŠŠå­—å…¸ä¸­çš„å­—å…¸å’Œåˆ—è¡¨è¿›è¡Œä¿®æ”¹</span>
d<span class="token operator">=</span>copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">#æ·±æ‹·è´ï¼Œé€’å½’å¤åˆ¶</span>
b<span class="token punctuation">[</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">5</span>
c<span class="token punctuation">[</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span>
</code></pre></div><pre><code>{'c': 5} {'c': 5} {'c': 6} {}
</code></pre> <p>yuan</p> <h4 id="dictç”¨æ³•è¡¥å……"><a href="#dictç”¨æ³•è¡¥å……" aria-hidden="true" class="header-anchor">#</a> dictç”¨æ³•è¡¥å……</h4> <div class="language-python extra-class"><pre class="language-python"><code>a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span>
dic<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
dic<span class="token punctuation">.</span>fromkeys<span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token string">&quot;æ²™é›•ç‰›è‚‰&quot;</span><span class="token punctuation">)</span><span class="token comment">#ä¼ å…¥ä¸€ä¸ª å¯è¿­ä»£å¯¹è±¡ï¼Œé»˜è®¤å€¼ ç”Ÿæˆå­—å…¸</span>
dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;æƒ³å–çš„ç´¢å¼•&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å–ä¸åˆ°å°±è¿”å›çš„é»˜è®¤å€¼&quot;</span><span class="token punctuation">)</span>
dic<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">&quot;ç´¢å¼•&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å€¼&quot;</span><span class="token punctuation">)</span><span class="token comment">#å…ˆæ·»åŠ æˆ–æ›´æ”¹ä¸€ä¸ªé”®å€¼å¯¹ï¼Œç„¶åå–å‡º</span>
dic<span class="token punctuation">.</span>update<span class="token punctuation">(</span>Iterable<span class="token punctuation">)</span><span class="token comment">#å°†è¿™ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸€èˆ¬æ˜¯é”®å€¼å¯¹å½¢å¼æ·»åŠ åˆ°å­—å…¸ä¸­å»ï¼Œ[(a,b),(c,d)] a=b,c=d {&quot;a&quot;:&quot;b&quot;,&quot;c&quot;:&quot;d&quot;}</span>
</code></pre></div><pre><code>'é»˜è®¤å€¼'
</code></pre> <div class="danger custom-block"><p class="custom-block-title">åŸç”Ÿç»“æ„</p> <p>pythonåŸç”Ÿçš„ä¸€äº›æ•°æ®ç»“æ„list dictç­‰ç­‰ç›´æ¥ç»§æ‰¿åœ¨æŸäº›æƒ…å†µä¸‹ä¸ä¼šç”Ÿæ•ˆ<br>
æœ€å¥½ç»§æ‰¿collections UserDictï¼ŒliståŒç†</p></div> <h4 id="setçš„ç”¨æ³•è¡¥å……"><a href="#setçš„ç”¨æ³•è¡¥å……" aria-hidden="true" class="header-anchor">#</a> setçš„ç”¨æ³•è¡¥å……</h4> <p>setæ˜¯ä¸€ä¸ªæ— åºä¸é‡å¤é›†åˆä¿®æ”¹ç”¨addï¼ˆï¼‰delï¼ˆï¼‰popï¼ˆï¼‰ç­‰ç­‰ï¼Œfrozensetæ˜¯ä¸å¯å˜é›†åˆï¼Œæ— æ³•ä¿®æ”¹ä½†æ˜¯å¯ä»¥ä½œä¸ºdictçš„key</p> <div class="language-python extra-class"><pre class="language-python"><code>s<span class="token operator">=</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">&quot;def&quot;</span><span class="token punctuation">)</span><span class="token comment">#ä¼šæŠŠè¿­ä»£å¯¹è±¡åˆ†åˆ«ä½œä¸ºå…ƒç´ </span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token comment">#ç›´æ¥æ·»åŠ </span>
s<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token comment">#ä¼šæŠŠè¿­ä»£å¯¹è±¡åˆ†åˆ«ä½œä¸ºå…ƒç´ </span>
d<span class="token operator">=</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">&quot;defgh&quot;</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>difference<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token comment">#æ¯”è¾ƒä¸¤ä¸ªsetçš„ä¸åŒï¼Œå–å·®é›†ï¼Œæ˜¯ä¸€ä¸ªæ–°çš„setï¼Œä¸»è¦çš„æ“ä½œ |å¹¶ &amp;äº¤ -å·®</span>
</code></pre></div><pre><code>{'a', 'abc', 'b', 'c'}
</code></pre> <div class="tip custom-block"><p class="custom-block-title">åƒåœ¾å›æ”¶</p> <p>pythonä¸­çš„åƒåœ¾å›æ”¶ç®—æ³•æ˜¯å¼•ç”¨è®¡æ•°ï¼Œä¸€ä¸ªå˜é‡æœ‰nä¸ªå¼•ç”¨ï¼Œå½“å¼•ç”¨è®¡æ•°å˜ä¸º 0 å³å›æ”¶åƒåœ¾ï¼Œdelå‡½æ•°å¯å®Œæˆæ›´é«˜çº§çš„åƒåœ¾å›æ”¶
å‚æ•°ç»å¯¹ä¸èƒ½ç”¨å¯å˜å¯¹è±¡ï¼ˆlistï¼‰
æ³¨æ„ç¯å½¢å¼•ç”¨é—®é¢˜</p></div> <h3 id="collectionsçš„ç”¨æ³•"><a href="#collectionsçš„ç”¨æ³•" aria-hidden="true" class="header-anchor">#</a> collectionsçš„ç”¨æ³•</h3> <h4 id="å…³äºqueue-dequeue-counter-partial-chainmap-namedtuple-defaultdict-chain"><a href="#å…³äºqueue-dequeue-counter-partial-chainmap-namedtuple-defaultdict-chain" aria-hidden="true" class="header-anchor">#</a> å…³äºqueue dequeue Counter partial ChainMap namedtuple defaultdict Chain</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/23 16:34&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">import</span> collections
<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple<span class="token punctuation">,</span>defaultdict<span class="token punctuation">,</span>deque<span class="token punctuation">,</span>Counter<span class="token punctuation">,</span>ChainMap
<span class="token keyword">from</span> functools <span class="token keyword">import</span> partial<span class="token comment">#åŒ…è£¹å‡½æ•°è¿”å›å¥æŸ„</span>
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> chain<span class="token comment">#ä¼ å…¥å¥½å‡ ä¸ªå¯è¿­ä»£ä¸€å—è¿­ä»£</span>
<span class="token keyword">from</span> pprint <span class="token keyword">import</span> pprint<span class="token comment">#æ¼‚äº®æ‰“å°</span>
<span class="token keyword">from</span> copy <span class="token keyword">import</span> deepcopy<span class="token comment">#æ·±æ‹·è´</span>
<span class="token comment">#your class&amp;function here</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    tup<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token comment">#tupleæ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œæœ‰åº</span>
    a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token operator">=</span>tup<span class="token comment">#å¯ä»¥ç›´æ¥æ‹†åŒ…</span>
    d<span class="token punctuation">,</span><span class="token operator">*</span>other<span class="token operator">=</span>tup<span class="token comment">#dæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå…¶ä»–çš„ä¸ç®¡äº†</span>
    <span class="token comment">#cè¯­è¨€ä¸­tupleæ˜¯structè€Œlistå´æ˜¯arryï¼Œtupleåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ç¡®å®šï¼Œæ€§èƒ½å¼ºï¼Œå¯ä½œä¸ºdicçš„keyï¼Œä¸å¯å˜-&gt;å¯å“ˆå¸Œ</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span>
<span class="token comment">#namedtupleçš„ç”¨æ³•</span>
    dic<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token string">&quot;country&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;china&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;height&quot;</span><span class="token punctuation">:</span><span class="token number">165</span><span class="token punctuation">,</span><span class="token string">&quot;edu&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;master&quot;</span><span class="token punctuation">}</span>
    User<span class="token operator">=</span>namedtuple<span class="token punctuation">(</span><span class="token string">&quot;User&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;country&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;height&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;edu&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#ä¼šç»™ä½ åˆ›å»ºä¸€ä¸ªç±»ï¼Œç±»ååŠ å±æ€§åˆ—è¡¨</span>
    user<span class="token operator">=</span>User<span class="token punctuation">(</span>age<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">,</span>country<span class="token operator">=</span><span class="token string">&quot;china&quot;</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">165</span><span class="token punctuation">,</span>edu<span class="token operator">=</span><span class="token string">&quot;mm&quot;</span><span class="token punctuation">)</span><span class="token comment">#å¯ä»¥æŒ‰å±æ€§åå®ä¾‹åŒ–ï¼Œå¹¶ä¸”å±æ€§åä¸å¯å˜</span>
    f<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token string">&quot;china&quot;</span><span class="token punctuation">,</span><span class="token number">165</span><span class="token punctuation">)</span>
    user2<span class="token operator">=</span>User<span class="token punctuation">(</span><span class="token operator">*</span>f<span class="token punctuation">,</span><span class="token string">&quot;muster&quot;</span><span class="token punctuation">)</span><span class="token comment">#å’Œä¸Šé¢åˆå§‹åŒ–æ˜¯ä¸€æ ·,å¹¶ä¸”é¢å¤–ä¼ å…¥äº†äº†masterè¿™ä¸ªå±æ€§</span>
    <span class="token comment">#ä»æ•°æ®åº“é‡Œæ‹¿å‡ºæ¥å°‘äº†ä¸€åˆ—çš„è¯å¯ä»¥ç›´æ¥åŠ ä¸Š</span>
    user3<span class="token operator">=</span>User<span class="token punctuation">(</span><span class="token operator">**</span>dic<span class="token punctuation">)</span><span class="token comment">#ç”¨å­—å…¸å®ä¾‹åŒ–</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>user3<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;age is :&quot;</span><span class="token punctuation">,</span>user2<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token comment">#çœç©ºé—´ï¼Œå†…å­˜å’Œæ¶ˆè€—å°ï¼Œå‚æ•°å°±æ˜¯ç”¨tupleå®Œæˆçš„</span>
    <span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token string">&quot;print('hello')&quot;</span><span class="token punctuation">)</span><span class="token comment">#æ‰§è¡Œä»£ç </span>
<span class="token comment">#defualtdictçš„ç”¨æ³•,cå†™çš„,è¿˜æœ‰setdefault</span>
dic<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'runoob'</span><span class="token punctuation">:</span> <span class="token string">'èœé¸Ÿ'</span><span class="token punctuation">,</span> <span class="token string">'google'</span><span class="token punctuation">:</span> <span class="token string">'Google æœç´¢'</span><span class="token punctuation">}</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Value : %s&quot;</span> <span class="token operator">%</span> dic<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">'runoob'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è°ƒç”¨setdefaultçš„æ—¶å€™ï¼Œæ‰¾ä¸åˆ°å°±è¿”å›è¿™ä¸ªdefaultå€¼</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Value : %s&quot;</span> <span class="token operator">%</span> dic<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">'Taobao'</span><span class="token punctuation">,</span> <span class="token string">'æ·˜å®'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">de</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;booon&quot;</span><span class="token punctuation">}</span>
d<span class="token operator">=</span>defaultdict<span class="token punctuation">(</span>de<span class="token punctuation">)</span><span class="token comment">#ä¼ å…¥ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œå¦‚æœå­—å…¸æ²¡æœ‰æ‰¾åˆ°ä½ è¦çš„ğŸ—¡ï¼Œå°±ç»™ä½ æ–°å»ºä¸€ä¸ªé”®å€¼ä¸ºå¯¹è±¡çš„è¿”å›å€¼,å¯ç”¨å‡½æ•°åŒ…è£…ä¸€ä¸‹</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;sansum&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;HP&quot;</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token comment">#inté»˜è®¤ä¸º0,listé»˜è®¤ç©ºå­—å…¸</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#dequeåŒç«¯é˜Ÿåˆ—</span>
x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
q<span class="token operator">=</span>deque<span class="token punctuation">(</span>x<span class="token punctuation">,</span>maxlen<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token comment">#å¯è¿­ä»£å¯¹è±¡ï¼Œæœ€å¤§é•¿åº¦</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>
q<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æ¸…ç©º</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>
q<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token comment">#æ·»åŠ å¯¹è±¡</span>
q<span class="token punctuation">.</span>appendleft<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#å‘å·¦ç«¯æ·»åŠ å¯¹è±¡</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è¿”å›6å‡ºç°çš„æ¬¡æ•°</span>
q1<span class="token operator">=</span>q<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æµ…æ‹·è´</span>
q2<span class="token operator">=</span>deepcopy<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token comment">#æ·±æ‹·è´</span>
q<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>q1<span class="token punctuation">)</span><span class="token comment">#åˆå¹¶ï¼Œç›´æ¥åœ¨åŸæ¥dequeæ“ä½œï¼Œä¸ä¼šè¿”å›æ–°çš„</span>
q<span class="token punctuation">.</span>extendleft<span class="token punctuation">(</span>q1<span class="token punctuation">)</span><span class="token comment">#ä»å·¦è¾¹åˆå¹¶ï¼Œç›´æ¥åœ¨åŸæ¥dequeæ“ä½œï¼Œä¸ä¼šè¿”å›æ–°çš„</span>
q<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">)</span><span class="token comment">#åœ¨ä¸‹æ ‡ä¸º3åœ°æ–¹æ’å…¥</span>
q<span class="token punctuation">.</span>reverse<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#ç¿»è½¬</span>
q<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#è¿”å›æœ€åä¸€ä¸ªå¹¶åˆ é™¤</span>
q<span class="token punctuation">.</span>popleft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#è¿”å›æœ€å·¦è¾¹çš„ä¸€ä¸ªå¹¶åˆ é™¤</span>
q<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment">#åœ¨0-5ä¸‹æ ‡ä¹‹é—´æŸ¥æ‰¾6</span>
<span class="token comment">#Counterçš„ä½¿ç”¨</span>
a<span class="token operator">=</span><span class="token string">&quot;sadbsdvfbdjfbdksdv&quot;</span>
s<span class="token operator">=</span>Counter<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">#ä¼ å…¥ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡å­—ç¬¦ä¸²åˆ—è¡¨ä»€ä¹ˆçš„ï¼Œç»Ÿè®¡å…ƒç´ å‡ºç°æ¬¡æ•°</span>
s1<span class="token operator">=</span>Counter<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>update<span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token comment">#æŠŠä¸¤ä¸ªCounteråŠ èµ·æ¥</span>
pprint<span class="token punctuation">(</span>s<span class="token punctuation">.</span>most_common<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#æœ€å¤šæ¬¡æ•°çš„ä¿©ï¼Œæ˜¯åˆ—è¡¨</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> ChainMap<span class="token punctuation">(</span>s<span class="token punctuation">,</span>s1<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pprint<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token comment">#æŠŠä¿©å­—å…¸åˆæˆChainmapå¯¹è±¡ï¼Œä½†æ˜¯ä¸æ˜¯åŠ åœ¨ä¸€èµ·äº†ï¼Œè¿­ä»£çš„æ—¶å€™å‰é¢å‡ºç°çš„å…ƒç´ åé¢ä¸ä¼šåœ¨æ‰“å°</span>

</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>æ¥ä¸‹æ¥çš„ä»£ç ä¼šå¾ˆå¤šæˆ‘åœ¨PyCharmé‡Œé¢å†™ç„¶åå¤åˆ¶è¿‡æ¥</p></div> <h2 id="ä¸‰ç¥å™¨"><a href="#ä¸‰ç¥å™¨" aria-hidden="true" class="header-anchor">#</a> ä¸‰ç¥å™¨</h2> <h3 id="è£…é¥°å™¨-ç•™å‘"><a href="#è£…é¥°å™¨-ç•™å‘" aria-hidden="true" class="header-anchor">#</a> è£…é¥°å™¨(ç•™å‘)</h3> <p>è‡ªå®šä¹‰get setæ–¹æ³•</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@property</span>
@è¢«è£…é¥°çš„ç±»<span class="token punctuation">.</span>setter
@è¢«è£…é¥°çš„ç±»<span class="token punctuation">.</span>getter
</code></pre></div><h3 id="å±æ€§æŸ¥æ‰¾è¿‡ç¨‹"><a href="#å±æ€§æŸ¥æ‰¾è¿‡ç¨‹" aria-hidden="true" class="header-anchor">#</a> å±æ€§æŸ¥æ‰¾è¿‡ç¨‹</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>birth<span class="token punctuation">,</span>day<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>birth<span class="token operator">=</span>birth
        self<span class="token punctuation">.</span>day<span class="token operator">=</span>day

    <span class="token keyword">def</span> <span class="token function">__getattr__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#æ‰¾ä¸åˆ°å±æ€§çš„æ—¶å€™ä¼šè¿›å…¥è¿™ä¸ªå‡½æ•°</span>
        <span class="token keyword">return</span> <span class="token string">&quot;æ²¡å‘ç°&quot;</span><span class="token operator">+</span>item

    <span class="token keyword">def</span> <span class="token function">__getattribute__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#åªè¦æŸ¥æ‰¾å±æ€§å°±ä¼šè¿›å…¥è¿™é‡Œ</span>
        <span class="token keyword">return</span> <span class="token string">&quot;å‘ç°äº†&quot;</span><span class="token operator">+</span>item

a<span class="token operator">=</span>A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span>name
</code></pre></div><pre><code>'å‘ç°äº†name'
</code></pre> <p>ä½¿ç”¨å±æ€§æè¿°ç¬¦é™åˆ¶ä¼ å€¼çš„ç±»å‹ï¼Œå‚è€ƒDjangoçš„forméªŒè¯<br>
å¦‚æœuseræ˜¯æŸä¸ªç±»çš„å®ä¾‹ï¼Œé‚£ä¹ˆuser.age ä»¥åŠç­‰ä»·çš„getattr(user,age)<br></p> <ul><li><p>é¦–å…ˆè°ƒç”¨__getattribute__ã€‚å¦‚æœç±»å®šä¹‰äº† __getattr__æ–¹æ³•ï¼Œ<br></p></li> <li><p>é‚£ä¹ˆåœ¨____getattribute__æ‹‹å‡ºAttributeErrorçš„æ—¶å€™å°±ä¼šè°ƒç”¨åˆ°__getattr__ï¼Œ<br></p></li></ul> <p>è€Œå¯¹äºæè¿°ç¬¦(<strong>get</strong>)çš„è°ƒç”¨ï¼Œåˆ™æ˜¯å‘ç”Ÿåœ¨__getattribute__å†…éƒ¨çš„<br></p> <p>user = User(),é‚£ä¹ˆuser.age é¡ºåºå¦‚ä¸‹ï¼š<br></p> <ol><li>E3æœâ€œâ€æ˜¯å‡ºç°åœ¨Useræˆ–å…¶åŸºç±»çš„__diet__ä¸­ï¼Œä¸”ageæ˜¯data descriptorï¼Œ<br></li> <li>å¦‚æœâ€œageâ€å‡ºç°åœ¨objçš„__diet__ä¸­ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›obj.<strong>diet</strong>[fageâ€™],<br></li> <li>å¦‚æœâ€œageâ€å‡ºç°åœ¨Useræˆ–å…¶åŸºç±»çš„__dict__*<br> <ul><li>å¦‚æœageæ˜¯non-data descriptor,é‚£ä¹ˆè°ƒç”¨å…¶__get__æ–¹ æ³• ï¼Œ å¦ åˆ™<br></li> <li>è¿”å› <strong>dict</strong>[fageâ€™]<br></li></ul></li> <li>å¦‚æœUseræœ‰__getattr__æ–¹æ³•ï¼Œè°ƒç”¨__getattr__æ–¹æ³•ï¼Œå¦åˆ™<br></li> <li>æŠ›å‡ºAttributeError<br></li></ol> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#ä»£è¡¨æœ¬ç±»</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#ä»£è¡¨æœ¬å¯¹è±¡</span>

</code></pre></div><pre><code>  File &quot;&lt;ipython-input-2-00e9d8750bd0&gt;&quot;, line 5

    ^
SyntaxError: unexpected EOF while parsing
</code></pre> <div class="tip custom-block"><p class="custom-block-title">newå’Œinit</p> <p>newæ˜¯ç”¨æ¥è‡ªå®šä¹‰ç±»äº§ç”Ÿè¿‡ç¨‹çš„é€»è¾‘<br>initæ˜¯ç”¨æ¥å®šä¹‰å®ä¾‹äº§ç”Ÿçš„è¿‡ç¨‹çš„<br>
å¦‚æœnewæ²¡æœ‰è¿”å›å¯¹è±¡ï¼Œåˆ™ä¸ä¼šè¿›å…¥å®ä¾‹åŒ–é˜¶æ®µ</p></div> <h3 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" aria-hidden="true" class="header-anchor">#</a> è¿­ä»£å™¨</h3> <h4 id="è¿­ä»£å™¨æ˜¯å®ç°çš„è¿­ä»£åè®®"><a href="#è¿­ä»£å™¨æ˜¯å®ç°çš„è¿­ä»£åè®®" aria-hidden="true" class="header-anchor">#</a> è¿­ä»£å™¨æ˜¯å®ç°çš„è¿­ä»£åè®®</h4> <p>æ— æ³•ä¸‹æ ‡è®¿é—®ï¼ˆgetitemï¼‰ä¸ç›´æ¥è¿”å›ï¼Œæƒ°æ€§è¿”å›æ•°æ®çš„æ–¹å¼<br>iterable-&gt; iterå‡½æ•° å’Œtierator-&gt;netxå‡½æ•° <br>
å®é™…è®¿é—®é€šè¿‡çš„æ˜¯next</p> <h3 id="ç”Ÿæˆå™¨"><a href="#ç”Ÿæˆå™¨" aria-hidden="true" class="header-anchor">#</a> ç”Ÿæˆå™¨</h3> <h4 id="åªè¦æ˜¯å«æœ‰yieldçš„å°±æ˜¯ç”Ÿæˆå™¨"><a href="#åªè¦æ˜¯å«æœ‰yieldçš„å°±æ˜¯ç”Ÿæˆå™¨" aria-hidden="true" class="header-anchor">#</a> åªè¦æ˜¯å«æœ‰yieldçš„å°±æ˜¯ç”Ÿæˆå™¨</h4> <p>æä¾›äº†æƒ°æ€§æ±‚å€¼<br>
pythonâ€”åˆ‡çš†å¯¹è±¡ï¼Œæ ˆå¸§å¯¹è±¡ï¼Œå­—èŠ‚ç å¯¹è±¡<br>
å½“fooè°ƒç”¨å­å‡½æ•°barï¼Œåˆå£«åˆ›å»ºä¸€ä¸ªæ ˆå¸§<br>
æ‰€æœ‰çš„æ ˆå¸§éƒ½æ˜¯åˆ†é…åœ¨å †å†…å­˜ä¸Šï¼Œè¿™å°±å†³å®šäº†æ ˆå¸§å¯ä»¥ç‹¬ç«‹äºè°ƒç”¨è€…å­˜åœ¨<br>
é™æ€è¯­è¨€æ˜¯æ”¾åˆ°æ ˆä¸Šè¿è¡Œå®Œæ¯•ä¹‹åä¼šé”€æ¯<br>åŠ¨æ€è¯­è¨€æ”¾åœ¨å †ä¸Šï¼Œæ‰¾åˆ°æ ˆå¸§å¯ä»¥æŒç»­è°ƒç”¨<br></p> <p><img src="https://upload-images.jianshu.io/upload_images/12620393-3e2b72fd6678a24b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ ˆå¸§å­—èŠ‚ç "></p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>åŸç”Ÿè¿‡ç¨‹æ˜¯å°†é€’å½’ä¹‹åçš„å­—èŠ‚ç éƒ½å‹åˆ°æ ˆå¸§é‡Œå»ï¼Œç„¶åå‡½æ•°çš„æŒ‡é’ˆæŒ‡å‘æœ€è¿‘ä¸€æ¬¡è¿è¡Œçš„æ ˆå¸§ï¼Œè¿è¡Œä¹‹åå°±ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªæ ˆå¸§æ‰€ä»¥å¯ä»¥é¡ºåˆ©çš„yield</p></div> <p><img src="https://upload-images.jianshu.io/upload_images/12620393-401946d7f7695b32.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ ˆå¸§"></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;10/12/2018 3:51 PM&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">import</span> dis
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> collections<span class="token punctuation">.</span>abc <span class="token keyword">import</span> Mapping<span class="token punctuation">,</span>MutableMapping
<span class="token comment">#your class&amp;function here</span>
<span class="token keyword">def</span> <span class="token function">generat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">yield</span> <span class="token number">1</span>
    s<span class="token operator">=</span><span class="token string">&quot;æˆ‘æ˜¯s&quot;</span>
    <span class="token keyword">yield</span> <span class="token number">2</span>
    m <span class="token operator">=</span> <span class="token string">&quot;æˆ‘æ˜¯m&quot;</span>
    <span class="token keyword">yield</span> <span class="token number">3</span>

<span class="token keyword">def</span> <span class="token function">gen_fib</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n<span class="token punctuation">,</span>f0<span class="token punctuation">,</span>f1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
    <span class="token keyword">while</span> n<span class="token operator">&lt;=</span>index<span class="token punctuation">:</span>
        f0<span class="token punctuation">,</span>f1<span class="token operator">=</span>f1<span class="token punctuation">,</span>f1<span class="token operator">+</span>f0
        <span class="token keyword">yield</span> f0
        n<span class="token operator">+=</span><span class="token number">1</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    ge<span class="token operator">=</span>generat<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>dis<span class="token punctuation">.</span>dis<span class="token punctuation">(</span>ge<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ge<span class="token punctuation">.</span>gi_frame<span class="token punctuation">.</span>f_lasti<span class="token punctuation">)</span><span class="token comment">#æœ€åæŒ‡å‘æ ˆå¸§çš„æŒ‡é’ˆ</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ge<span class="token punctuation">.</span>gi_frame<span class="token punctuation">.</span>f_locals<span class="token punctuation">)</span><span class="token comment">#æœ¬åœ°å˜é‡</span>
    <span class="token builtin">next</span><span class="token punctuation">(</span>ge<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ge<span class="token punctuation">.</span>gi_frame<span class="token punctuation">.</span>f_lasti<span class="token punctuation">)</span><span class="token comment">#æœ€åæŒ‡å‘æ ˆå¸§çš„æŒ‡é’ˆ</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ge<span class="token punctuation">.</span>gi_frame<span class="token punctuation">.</span>f_locals<span class="token punctuation">)</span><span class="token comment">#æœ¬åœ°å˜é‡</span>
    <span class="token builtin">next</span><span class="token punctuation">(</span>ge<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ge<span class="token punctuation">.</span>gi_frame<span class="token punctuation">.</span>f_lasti<span class="token punctuation">)</span><span class="token comment">#æœ€åæŒ‡å‘æ ˆå¸§çš„æŒ‡é’ˆ</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ge<span class="token punctuation">.</span>gi_frame<span class="token punctuation">.</span>f_locals<span class="token punctuation">)</span><span class="token comment">#æœ¬åœ°å˜é‡</span>
    <span class="token builtin">next</span><span class="token punctuation">(</span>ge<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ge<span class="token punctuation">.</span>gi_frame<span class="token punctuation">.</span>f_lasti<span class="token punctuation">)</span><span class="token comment">#æœ€åæŒ‡å‘æ ˆå¸§çš„æŒ‡é’ˆ</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ge<span class="token punctuation">.</span>gi_frame<span class="token punctuation">.</span>f_locals<span class="token punctuation">)</span><span class="token comment">#æœ¬åœ°å˜é‡</span>
    <span class="token builtin">next</span><span class="token punctuation">(</span>ge<span class="token punctuation">)</span>
    <span class="token comment"># for i in ge:</span>
    <span class="token comment">#     print(i)</span>
    <span class="token comment"># for i in gen_fib(50):</span>
    <span class="token comment">#     print(i)</span>
</code></pre></div><pre><code> 12           0 LOAD_CONST               1 (1)
              2 YIELD_VALUE
              4 POP_TOP

 13           6 LOAD_CONST               2 ('æˆ‘æ˜¯s')
              8 STORE_FAST               0 (s)

 14          10 LOAD_CONST               3 (2)
             12 YIELD_VALUE
             14 POP_TOP

 15          16 LOAD_CONST               4 ('æˆ‘æ˜¯m')
             18 STORE_FAST               1 (m)

 16          20 LOAD_CONST               5 (3)
             22 YIELD_VALUE
             24 POP_TOP
             26 LOAD_CONST               0 (None)
             28 RETURN_VALUE
None
-1
{}
2
{}
12
{'s': 'æˆ‘æ˜¯s'}
22
{'s': 'æˆ‘æ˜¯s', 'm': 'æˆ‘æ˜¯m'}



---------------------------------------------------------------------------

StopIteration                             Traceback (most recent call last)

&lt;ipython-input-9-c12afe8f7bdb&gt; in &lt;module&gt;()
     37     print(ge.gi_frame.f_lasti)#æœ€åæŒ‡å‘æ ˆå¸§çš„æŒ‡é’ˆ
     38     print(ge.gi_frame.f_locals)#æœ¬åœ°å˜é‡
---&gt; 39     next(ge)
     40     # for i in ge:
     41     #     print(i)


StopIteration:
</code></pre> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#### è¯»å–ä¸€è¡Œè¶…å¤§æ–‡ä»¶æœ‰åˆ†éš”ç¬¦</span>
è¶…å¤§ä¸€è¡Œæ–‡ä»¶<span class="token punctuation">,</span>ä¸èƒ½ç›´æ¥read<span class="token punctuation">,</span>readlineä¹Ÿä¸è¡Œå› ä¸ºåªæœ‰ä¸€è¡Œ<span class="token punctuation">,</span>å†…å­˜ä¼šçˆ†æ‰
<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">:</span>tip
ä½¿ç”¨è¿­ä»£å™¨æƒ°æ€§è¿”å›<span class="token punctuation">,</span>è®¾ç½®<span class="token builtin">buffer</span>ä»£ç å¦‚ä¸‹
<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">:</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>
<span class="token keyword">def</span> <span class="token function">myreadlines</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>newline<span class="token punctuation">)</span><span class="token punctuation">:</span>
    buf<span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> newline <span class="token keyword">in</span> buf <span class="token punctuation">:</span>
            pos<span class="token operator">=</span>buf<span class="token punctuation">.</span>index<span class="token punctuation">(</span>newline<span class="token punctuation">)</span>
            <span class="token keyword">yield</span> buf<span class="token punctuation">[</span><span class="token punctuation">:</span>pos<span class="token punctuation">]</span>
            buf<span class="token operator">=</span>buf<span class="token punctuation">[</span>pos<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>newline<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        chunk<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> chunk<span class="token punctuation">:</span>
            <span class="token keyword">yield</span> buf
            <span class="token keyword">break</span>
        buf<span class="token operator">+=</span>chunk

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;./files/a.txt&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;r&quot;</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> myreadlines<span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token string">&quot;|&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
</code></pre></div><pre><code>sdfghRSXCSYDVASYEDCRAVSBWDYGT
exrsadcsvydbasfygv7aysdsaidbas9dunb
shdvgyascvdtysacdysgbdyuasfvy
dsfvgyasuvbdas87fydvasyfvi
dvfysaded7ftv7sadybs
sdyfb87dygvfds7ybnfufvwb8dfvbe6tvdb8uvfwy8duiygwdf
sedfuwyiyfrte7y8urgevtfbyefb7vyd8unedyb8
edyundimgrfey8unimdgrvyb8unwime
</code></pre> <h2 id="websocket"><a href="#websocket" aria-hidden="true" class="header-anchor">#</a> WebSocket</h2> <h3 id="åŸºæœ¬çš„api"><a href="#åŸºæœ¬çš„api" aria-hidden="true" class="header-anchor">#</a> åŸºæœ¬çš„API</h3> <ul><li><strong>sk.bind(address)</strong></li></ul> <p>s.bind(address) å°†å¥—æ¥å­—ç»‘å®šåˆ°åœ°å€ã€‚addressåœ°å€çš„æ ¼å¼å–å†³äºåœ°å€æ—ã€‚åœ¨AF_INETä¸‹ï¼Œä»¥å…ƒç»„ï¼ˆhost,portï¼‰çš„å½¢å¼è¡¨ç¤ºåœ°å€ã€‚</p> <ul><li><strong>sk.listen(backlog)</strong></li></ul> <p>å¼€å§‹ç›‘å¬ä¼ å…¥è¿æ¥ã€‚backlogæŒ‡å®šåœ¨æ‹’ç»è¿æ¥ä¹‹å‰ï¼Œå¯ä»¥æŒ‚èµ·çš„æœ€å¤§è¿æ¥æ•°é‡ã€‚</p> <pre><code>  backlogç­‰äº5ï¼Œè¡¨ç¤ºå†…æ ¸å·²ç»æ¥åˆ°äº†è¿æ¥è¯·æ±‚ï¼Œä½†æœåŠ¡å™¨è¿˜æ²¡æœ‰è°ƒç”¨acceptè¿›è¡Œå¤„ç†çš„è¿æ¥ä¸ªæ•°æœ€å¤§ä¸º5
  è¿™ä¸ªå€¼ä¸èƒ½æ— é™å¤§ï¼Œå› ä¸ºè¦åœ¨å†…æ ¸ä¸­ç»´æŠ¤è¿æ¥é˜Ÿåˆ—
</code></pre> <ul><li><strong>sk.setblocking(bool)</strong></li></ul> <p>æ˜¯å¦é˜»å¡ï¼ˆé»˜è®¤Trueï¼‰ï¼Œå¦‚æœè®¾ç½®Falseï¼Œé‚£ä¹ˆacceptå’Œrecvæ—¶ä¸€æ—¦æ— æ•°æ®ï¼Œåˆ™æŠ¥é”™ã€‚</p> <ul><li><strong>sk.accept()</strong></li></ul> <p>æ¥å—è¿æ¥å¹¶è¿”å›ï¼ˆconn,addressï¼‰,å…¶ä¸­connæ˜¯æ–°çš„å¥—æ¥å­—å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥æ¥æ”¶å’Œå‘é€æ•°æ®ã€‚addressæ˜¯è¿æ¥å®¢æˆ·ç«¯çš„åœ°å€ã€‚</p> <p>æ¥æ”¶TCP å®¢æˆ·çš„è¿æ¥ï¼ˆé˜»å¡å¼ï¼‰ç­‰å¾…è¿æ¥çš„åˆ°æ¥</p> <ul><li><strong>sk.connect(address)</strong></li></ul> <p>è¿æ¥åˆ°addresså¤„çš„å¥—æ¥å­—ã€‚ä¸€èˆ¬ï¼Œaddressçš„æ ¼å¼ä¸ºå…ƒç»„ï¼ˆhostname,portï¼‰,å¦‚æœè¿æ¥å‡ºé”™ï¼Œè¿”å›socket.erroré”™è¯¯ã€‚</p> <ul><li><strong>sk.connect_ex(address)</strong></li></ul> <p>åŒä¸Šï¼Œåªä¸è¿‡ä¼šæœ‰è¿”å›å€¼ï¼Œè¿æ¥æˆåŠŸæ—¶è¿”å› 0 ï¼Œè¿æ¥å¤±è´¥æ—¶å€™è¿”å›ç¼–ç ï¼Œä¾‹å¦‚ï¼š10061</p> <ul><li><strong>sk.close()</strong></li></ul> <p>å…³é—­å¥—æ¥å­—</p> <ul><li><strong>sk.recv(bufsize[,flag])</strong></li></ul> <p>æ¥å—å¥—æ¥å­—çš„æ•°æ®ã€‚æ•°æ®ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ï¼ŒbufsizeæŒ‡å®šæœ€å¤šå¯ä»¥æ¥æ”¶çš„æ•°é‡ã€‚flagæä¾›æœ‰å…³æ¶ˆæ¯çš„å…¶ä»–ä¿¡æ¯ï¼Œé€šå¸¸å¯ä»¥å¿½ç•¥ã€‚</p> <ul><li><strong>sk.recvfrom(bufsize[.flag])</strong></li></ul> <p>ä¸recv()ç±»ä¼¼ï¼Œä½†è¿”å›å€¼æ˜¯ï¼ˆdata,addressï¼‰ã€‚å…¶ä¸­dataæ˜¯åŒ…å«æ¥æ”¶æ•°æ®çš„å­—ç¬¦ä¸²ï¼Œaddressæ˜¯å‘é€æ•°æ®çš„å¥—æ¥å­—åœ°å€ã€‚</p> <ul><li><strong>sk.send(string[,flag])</strong></li></ul> <p>å°†stringä¸­çš„æ•°æ®å‘é€åˆ°è¿æ¥çš„å¥—æ¥å­—ã€‚è¿”å›å€¼æ˜¯è¦å‘é€çš„å­—èŠ‚æ•°é‡ï¼Œè¯¥æ•°é‡å¯èƒ½å°äºstringçš„å­—èŠ‚å¤§å°ã€‚å³ï¼šå¯èƒ½æœªå°†æŒ‡å®šå†…å®¹å…¨éƒ¨å‘é€ã€‚</p> <ul><li><strong>sk.sendall(string[,flag])</strong></li></ul> <p>å°†stringä¸­çš„æ•°æ®å‘é€åˆ°è¿æ¥çš„å¥—æ¥å­—ï¼Œä½†åœ¨è¿”å›ä¹‹å‰ä¼šå°è¯•å‘é€æ‰€æœ‰æ•°æ®ã€‚æˆåŠŸè¿”å›Noneï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p> <pre><code>  å†…éƒ¨é€šè¿‡é€’å½’è°ƒç”¨sendï¼Œå°†æ‰€æœ‰å†…å®¹å‘é€å‡ºå»ã€‚
</code></pre> <ul><li><strong>sk.sendto(string[,flag],address)</strong></li></ul> <p>å°†æ•°æ®å‘é€åˆ°å¥—æ¥å­—ï¼Œaddressæ˜¯å½¢å¼ä¸ºï¼ˆipaddrï¼Œportï¼‰çš„å…ƒç»„ï¼ŒæŒ‡å®šè¿œç¨‹åœ°å€ã€‚è¿”å›å€¼æ˜¯å‘é€çš„å­—èŠ‚æ•°ã€‚è¯¥å‡½æ•°ä¸»è¦ç”¨äºUDPåè®®ã€‚</p> <ul><li><strong>sk.settimeout(timeout)</strong></li></ul> <p>è®¾ç½®å¥—æ¥å­—æ“ä½œçš„è¶…æ—¶æœŸï¼Œtimeoutæ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œå•ä½æ˜¯ç§’ã€‚å€¼ä¸ºNoneè¡¨ç¤ºæ²¡æœ‰è¶…æ—¶æœŸã€‚ä¸€èˆ¬ï¼Œè¶…æ—¶æœŸåº”è¯¥åœ¨åˆšåˆ›å»ºå¥—æ¥å­—æ—¶è®¾ç½®ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ç”¨äºè¿æ¥çš„æ“ä½œï¼ˆå¦‚ client è¿æ¥æœ€å¤šç­‰å¾…5s ï¼‰</p> <ul><li><strong>sk.getpeername()</strong></li></ul> <p>è¿”å›è¿æ¥å¥—æ¥å­—çš„è¿œç¨‹åœ°å€ã€‚è¿”å›å€¼é€šå¸¸æ˜¯å…ƒç»„ï¼ˆipaddr,portï¼‰ã€‚</p> <ul><li><strong>sk.getsockname()</strong></li></ul> <p>è¿”å›å¥—æ¥å­—è‡ªå·±çš„åœ°å€ã€‚é€šå¸¸æ˜¯ä¸€ä¸ªå…ƒç»„(ipaddr,port)</p> <ul><li><strong>sk.fileno()</strong></li></ul> <p>å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦</p> <h3 id="tcp-udpçš„ä½¿ç”¨ä»£ç "><a href="#tcp-udpçš„ä½¿ç”¨ä»£ç " aria-hidden="true" class="header-anchor">#</a> TCP/UDPçš„ä½¿ç”¨ä»£ç </h3> <h4 id="æœåŠ¡å™¨"><a href="#æœåŠ¡å™¨" aria-hidden="true" class="header-anchor">#</a> æœåŠ¡å™¨</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#__server__</span>
<span class="token keyword">import</span> socket
<span class="token comment">#tcp</span>
sk<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span><span class="token comment">#ä½¿ç”¨ipv4,TCP</span>
sk<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span><span class="token number">5333</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#ä¸€ä¸ªå…ƒç»„ç›‘å¬ï¼ˆip,ç«¯å£å·ï¼‰</span>
sk<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment">#è¯·æ±‚æ¥äº†è¢«æŒ‚èµ·çš„æœ€å¤§æ•°é‡ï¼Œè¶…è¿‡ä¹‹åä¾¿ä¸å†æ¥å—è¯·æ±‚</span>
sock<span class="token punctuation">,</span>addr<span class="token operator">=</span>sk<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#å…ˆaccepä¹‹åä¼šäº§ç”Ÿsockå’Œaddrä½¿ç”¨æœ¬sockå¯¹è±¡è¿›è¡Œæ“ä½œ</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span><span class="token comment">#ç”¨ä¸€ä¸ªwhile Trueæ¥ä¸æ–­æ¥å—è¯·æ±‚,è‹¥è¦å¤„ç†å¤šä¸ªè¯·æ±‚è¯·ç”¨å¤šçº¿ç¨‹</span>
    data<span class="token operator">=</span>sock<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token comment">#ä¸€æ¬¡æ¥å—1024ä¸ªBytes</span>
    recvmssage<span class="token operator">=</span>data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token comment">#å®¢æˆ·ç«¯æ€ä¹ˆç¼–ç å°±å¾—æ€ä¹ˆè§£ç </span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>recvmssage<span class="token punctuation">)</span>
    temp<span class="token operator">=</span><span class="token string">&quot;hello traveler&quot;</span>
    sock<span class="token punctuation">.</span>send<span class="token punctuation">(</span>temp<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å¯ä»¥æŒ‡å®šä¹Ÿå¯ä»¥ä¸åˆ¶å®šç¼–ç </span>
    sock<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#Tcpä¸€å®šè¦å…³é—­è¿æ¥</span>
<span class="token comment">#ä¸Šè¿°ç¨‹åºè¿›è¡Œä¸€æ¬¡ä¹‹åæ¥æ”¶ä¸åˆ°ä¸œè¥¿å°±ä¼šåœæ­¢ï¼Œéœ€è¦clientä¸æ–­å‘é€è‡ªè¡Œæ§åˆ¶å§</span>

<span class="token comment">#udp</span>
sk <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">)</span><span class="token comment">#ä½¿ç”¨ipv4,UDP</span>
sk<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span><span class="token number">5333</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#éœ€è¦ç»‘å®š(&quot;ip&quot;,port)</span>
data<span class="token punctuation">,</span> addr <span class="token operator">=</span> sk<span class="token punctuation">.</span>recvfrom<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token comment">#æ¥å—åˆ° æ•°æ®,åœ°å€(åœ°å€è¦ç•™ç€åé¢è¿˜è¦å‘å›å»)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#æ‰“å°</span>
temp<span class="token operator">=</span><span class="token string">&quot;the light will bring me vicetory&quot;</span>
sk<span class="token punctuation">.</span>sendto<span class="token punctuation">(</span>temp<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>addr<span class="token punctuation">)</span><span class="token comment">#å‘é€åˆ°addr</span>

</code></pre></div><h4 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" aria-hidden="true" class="header-anchor">#</a> å®¢æˆ·ç«¯</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#__client__</span>
<span class="token keyword">import</span> socket
<span class="token comment">#tcp</span>
sk<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span><span class="token comment">#ä½¿ç”¨ipv4 TCP</span>
sk<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span><span class="token number">5333</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#TCPæ˜¯éœ€è¦è¿æ¥çš„</span>
temp<span class="token operator">=</span><span class="token string">&quot;hello remote people&quot;</span>
sk<span class="token punctuation">.</span>send<span class="token punctuation">(</span>temp<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å‘é€åŒæ ·éœ€è¦ç¼–ç </span>
d<span class="token operator">=</span>sk<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token comment">#æ¥æ”¶å­—èŠ‚å¹¶è§£ç </span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
sk<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#éœ€è¦å…³é—­</span>

<span class="token comment">#udp</span>
sk <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">)</span><span class="token comment">#ç”¨ipv4,UDP</span>
addr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span><span class="token number">5333</span><span class="token punctuation">)</span><span class="token comment">#å…ˆç¡®å®šè‡ªå·±çš„åœ°å€</span>
data<span class="token operator">=</span><span class="token string">&quot;ha? me?&quot;</span>
sk<span class="token punctuation">.</span>sendto<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token comment">#å‘é€åˆ°ï¼Œè®°å¾—ç¼–ç </span>
recvdata<span class="token punctuation">,</span> addr<span class="token operator">=</span>sk<span class="token punctuation">.</span>recvfrom<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token comment">#æ¥å—ï¼ŒåŒæ ·éœ€è¦åŒºå¤§å°ï¼Œæœ€å¥½èƒ½ç»™ä¸ªbuffer</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>recvdata<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å‘é€çš„æ—¶å€™è¦è®°å¾—ç¼–ç </span>

</code></pre></div><h3 id="socketserverçš„ä½¿ç”¨"><a href="#socketserverçš„ä½¿ç”¨" aria-hidden="true" class="header-anchor">#</a> socketserverçš„ä½¿ç”¨</h3> <p>ç»§æ‰¿å…³ç³»å¦‚å›¾
<img src="https://upload-images.jianshu.io/upload_images/12620393-ec7af0bec463f5d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="socketserverçš„ç»§æ‰¿"></p> <p>import socketserver<br>
å°è£…å¥½äº†ä¸€äº›ä¸œè¥¿äº†æ‹¿æ¥ç›´æ¥ç”¨<br>
è°ƒç”¨æ–¹å¼ä¸º<br>
sock=socketserver.ThreadTCPServer((&quot;ip&quot;,port),HandlerClass)<br>
sock.server_foreverå¦‚æœçŸ¥é“åº”ç”¨ç¨‹åºåªèƒ½æ“çºµé¢å‘æ•°æ®æµçš„è¿æ¥ï¼ˆå¦‚TCPï¼‰ï¼Œé‚£ä¹ˆåº”ä»StreamRequestHandlerç»§æ‰¿ï¼Œè€Œä¸æ˜¯BaseRequestHandlerã€‚StreamRequestHandlerç±»è®¾ç½®äº†ä¸¤ä¸ªå±æ€§ï¼Œ<br>
h.wfileæ˜¯å°†æ•°æ®å†™å…¥å®¢æˆ·ç«¯çš„ç±»æ–‡ä»¶å¯¹è±¡ï¼Œh.rfileæ˜¯ä»å®¢æˆ·ç«¯è¯»å–æ•°æ®çš„ç±»æ–‡ä»¶å¯¹è±¡ã€‚<br>
å¦‚æœè¦ç¼–å†™é’ˆå¯¹æ•°æ®åŒ…æ“ä½œçš„å¤„ç†ç¨‹åºå¹¶å°†å“åº”æŒç»­è¿”å›å‘é€æ–¹ï¼Œé‚£ä¹ˆå®ƒåº”å½“ä»DatagramRequestHandlerç»§æ‰¿ã€‚<br>
å®ƒæä¾›çš„ç±»æ¥å£ä¸StramRequestHandlerç›¸åŒã€‚<br>
å¸¸ç”¨çš„handlerå±æ€§<br>
h.client_address#å®¢æˆ·ç«¯åœ°å€<br>
h.server#è·å–è‡ªå·±çš„serverå¯¹è±¡<br>
h.request<br>
å¯¹ TCP serverï¼Œh.request å±æ€§æ˜¯è¿æ¥åˆ° client çš„è¿æ¥å¥—æ¥å­—å¯¹è±¡ï¼›å°±æ˜¯é‚£ä¸ªsocket<br>
å¯¹ UDP serverï¼Œh.request å±æ€§æ˜¯ä¸€ä¸ªäºŒå…ƒç»„(data, sock)ï¼Œdata æ˜¯ client ç«¯å‘é€çš„æ•°æ®ï¼ˆæœ€å¤§8192å­—èŠ‚ï¼‰ï¼Œsockæ˜¯serverç«¯å¥—æ¥å­—ã€‚<br>
ã€€ã€€ä½¿ç”¨è¿™ä¸ªå±æ€§å¯ä»¥è·å–åœ¨è¿™ä¸ªè¿›/çº¿ç¨‹ä¸­ä¸clientå¥—æ¥å­—å»ºç«‹è¿æ¥çš„è¿æ¥å¥—æ¥å­—ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå¥—æ¥å­—ä¸clientç«¯é€šä¿¡ã€‚<br>
ã€€ã€€ StreamRequestHandler å’Œ DatagramRequestHandler åˆ™å±è”½äº† self.request å¯¹TCPå’ŒUDPè¿æ¥çš„åŒºåˆ«ï¼ŒäºŒè€…éƒ½é‡å®šä¹‰äº† setup() å’Œ finish() æ–¹æ³•ï¼Œæä¾›ç»Ÿä¸€çš„ self.rfile å’Œ self.wfile å±æ€§ä»¥ä¾¿ä»å®¢æˆ·ç«¯è¯»å–æ•°æ®æˆ–å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ã€‚<br>
ä»£ç å¦‚ä¸‹</p> <div class="danger custom-block"><p class="custom-block-title">ç•™å‘</p> <p>è¿™é‡Œæ²¡æ€ä¹ˆå®éªŒ</p></div> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> socketserver <span class="token keyword">import</span> BaseRequestHandler

<span class="token keyword">class</span> <span class="token class-name">MyHandl</span><span class="token punctuation">(</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;begine&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        conn<span class="token operator">=</span>self<span class="token punctuation">.</span>request<span class="token comment">#æ‹¿åˆ°è¯·æ±‚å¯¹è±¡</span>
        data<span class="token operator">=</span>conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token comment">#æ¥æ”¶</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        temp<span class="token operator">=</span><span class="token string">&quot;ä½ å¥½ï¼Œä½ å¥½~&quot;</span>
        conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>temp<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_address<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">finish</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;over&quot;</span><span class="token punctuation">)</span>

</code></pre></div><ul><li>ThreadTCPServer<br></li> <li>ThreadUDPServer<br></li> <li>ThreadingUnixStreamServer<br></li> <li>ThreadingUnixDatagramServer<br>
æ‰€æœ‰çš„Serveréƒ½æœ‰ä¸‹é¢çš„æ–¹æ³•</li></ul> <table><thead><tr><th>ç±»æˆ–è€…æ–¹æ³•</th> <th style="text-align:center">ä½œç”¨</th></tr></thead> <tbody><tr><td>sock.socket</td> <td style="text-align:center">ç”¨äºä¼ å…¥è¯·æ±‚çš„å¥—æ¥å­—å¯¹è±¡</td></tr> <tr><td>sock.server_address</td> <td style="text-align:center">ç›‘å¬æœåŠ¡å™¨çš„åœ°å€.æ¯”å¦‚å…ƒç»„(&quot;127.0.0.1&quot;,80)</td></tr> <tr><td>sock.RequestHandlerClass</td> <td style="text-align:center">ä¼ é€’ç»™æœåŠ¡å™¨æ„é€ å‡½æ•°å¹¶ç”±ç”¨æˆ·æä¾›çš„è¯·æ±‚å¤„ç†ç¨‹åºç±»</td></tr> <tr><td>sock.serve_forever()</td> <td style="text-align:center">å¤„ç†æ— é™çš„è¯·æ±‚</td></tr> <tr><td>sock.shutdown()</td> <td style="text-align:center">åœæ­¢serve_forever()å¾ªç¯</td></tr> <tr><td>sock.fileno()</td> <td style="text-align:center">è¿”å›æœåŠ¡å™¨å¥—æ¥å­—çš„æ•´æ•°æ–‡ä»¶æè¿°ç¬¦.è¯¥æ–¹æ³•å¯ä»¥æœ‰æ•ˆçš„é€šè¿‡è½®è¯¢æ“ä½œ(å¦‚select()å‡½æ•°)ä½¿ç”¨æœåŠ¡å™¨å®ä¾‹</td></tr></tbody></table> <h2 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" aria-hidden="true" class="header-anchor">#</a> å¤šçº¿ç¨‹</h2> <p>pythonä¸­çš„ä¸€ä¸ªçº¿ç¨‹å¯¹åº”cä¸­çš„ä¸€ä¸ªçº¿ç¨‹<br>å› ä¸ºGIL,åœ¨æŸä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨ä¸€ä¸ªcpuä¸Šæ‰§è¡Œå­—èŠ‚ç æ— æ³•å°†å¤šä¸ªçº¿ç¨‹æ˜ å°„åˆ°å¤šä¸ªæ ¸ä¸Š<br>
GILä¸æ˜¯åœ¨æœ¬çº¿ç¨‹ä½¿ç”¨å®Œä¹‹åæ‰ä¼šé‡Šæ”¾<br>æ ¹æ®æ‰§è¡Œçš„å­—èŠ‚ç å’Œæ—¶é—´ç‰‡å’ŒIOæ“ä½œæ‰é‡Šæ”¾ï¼Œå¯¼è‡´çº¿ç¨‹ä¸å®‰å…¨<br>
æœ€å¼€å§‹è¯­è¨€ä½¿ç”¨çš„éƒ½æ˜¯å¤šè¿›ç¨‹ï¼Œå¯¹ç³»ç»Ÿèµ„æºæ¶ˆè€—å¾ˆå¤§ï¼Œåæ¥å¼€å§‹ä½¿ç”¨çº¿ç¨‹ï¼Œçº¿ç¨‹æ˜¯ä¾é™„äºè¿›ç¨‹çš„ï¼Œ<br>æ“ä½œç³»ç»Ÿèƒ½è°ƒåº¦çš„æœ€å°å•ä½æ˜¯çº¿ç¨‹IOä¸ºä¸»çš„ç¨‹åºæ€§èƒ½å·®åˆ«ä¸å¤§<br>
å…·ä½“è¯·çœ‹<a href="www.baidu.com">æ“ä½œç³»ç»Ÿ-çº¿ç¨‹å’Œè¿›ç¨‹</a><br></p> <h3 id="ä½¿ç”¨çº¿ç¨‹å‡½æ•°å’Œçº¿ç¨‹ç±»"><a href="#ä½¿ç”¨çº¿ç¨‹å‡½æ•°å’Œçº¿ç¨‹ç±»" aria-hidden="true" class="header-anchor">#</a> ä½¿ç”¨çº¿ç¨‹å‡½æ•°å’Œçº¿ç¨‹ç±»</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/19 8:48&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread
<span class="token comment">#your class&amp;function here</span>

<span class="token keyword">class</span> <span class="token class-name">sayHello</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ç±»</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>someone<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#initä¼ å‚æ•°</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#è°ƒç”¨çˆ¶ç±»çš„æ„é€ </span>
        self<span class="token punctuation">.</span>someone<span class="token operator">=</span>someone<span class="token comment">#å‚æ•°</span>
        self<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span><span class="token comment">#åœ¨è¿™é‡Œè®¾ç½®å®ˆæŠ¤çº¿ç¨‹</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#é‡å†™runå‡½æ•°çº¿ç¨‹ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello &quot;</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>someone<span class="token punctuation">)</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">sayHi</span><span class="token punctuation">(</span>someone<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#å®šä¹‰ä¸€ä¸ªçº¿ç¨‹è¦ç”¨çš„å‡½æ•°</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hi &quot;</span><span class="token punctuation">,</span>someone<span class="token punctuation">)</span>

    t <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>sayHi<span class="token punctuation">,</span>args <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;janny&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å®ä¾‹åŒ–ä¸€ä¸ªå¿åŸ</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#å¼€å§‹æ‰§è¡Œ</span>

    namelist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;å¤©ä½¿&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;76&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å®‰å¨œ&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;æ³•é¸¡&quot;</span><span class="token punctuation">]</span>
    ThreadList<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment">#å®šä¹‰ä¸€ä¸ªçº¿ç¨‹åˆ—è¡¨</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> namelist<span class="token punctuation">:</span>
        ThreadList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sayHello<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#æ·»åŠ çº¿ç¨‹</span>
    ThreadList<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>setDaemon<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">#è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹,å…¶ä»–çº¿ç¨‹ç»“æŸçš„æ—¶å€™è‡ªåŠ¨ç»“æŸ</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ThreadList<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isAlive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è¿”å›çº¿ç¨‹æ˜¯å¦è¿˜æ´»ç€</span>
    ThreadList<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>setName<span class="token punctuation">(</span><span class="token string">&quot;ä½ å¥½çº¿ç¨‹&quot;</span><span class="token punctuation">)</span><span class="token comment">#è®¾ç½®çº¿ç¨‹åã€‚</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ThreadList<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>getName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è¿”å›çº¿ç¨‹åã€‚</span>

    <span class="token keyword">for</span> t <span class="token keyword">in</span> ThreadList<span class="token punctuation">:</span>
        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#å¼€å§‹ä¸€ä¸ªçº¿ç¨‹</span>
</code></pre></div><pre><code>Hi False
 ä½ å¥½çº¿ç¨‹
janny
Hello  å¤©ä½¿
Hello  76
Hello  Bob
Hello  å®‰å¨œ
Hello  æ³•é¸¡
</code></pre> <h3 id="çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—"><a href="#çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—" aria-hidden="true" class="header-anchor">#</a> çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—</h3> <p>LIFOé˜Ÿåˆ— åŸºæœ¬FIFOé˜Ÿåˆ— ä¼˜å…ˆçº§é˜Ÿåˆ—<br>
è¿™ä¸‰ç§åŸºç¡€é˜Ÿåˆ—å·²ç»å®ç°äº†çº¿ç¨‹å®‰å…¨</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/19 11:36&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">from</span> queue <span class="token keyword">import</span> Queue<span class="token punctuation">,</span>LifoQueue<span class="token punctuation">,</span>PriorityQueue
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread

<span class="token keyword">import</span> time
<span class="token comment">#your class&amp;function here</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment">#å…ˆè¿›å…ˆå‡ºFIFO ä¹Ÿå°±æ˜¯åŸºæœ¬çš„Queue</span>
    q<span class="token operator">=</span>Queue<span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token comment">#å®šä¹‰æœ€å¤§å®¹é‡,æ»¡äº†å°±ä¼šé˜»å¡çº¿ç¨‹,ä¸å®šä¹‰å°±é»˜è®¤æ— ä¸Šé™</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>i<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment">#å¾€é‡Œæ”¾ä¸€ä¸ªä¸œè¥¿,è¶…æ—¶æ—¶é—´</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>get<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è¿”å›äº†ä¸€ä¸ªå–å‡ºçš„å€¼ï¼Œè¶…æ—¶ç­‰å¾…æ—¶é—´</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;--------åˆ†å‰²----------&quot;</span>    <span class="token punctuation">)</span>

    <span class="token comment">#å…ˆè¿›åå‡ºLIFO</span>
    q<span class="token operator">=</span>LifoQueue<span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

    <span class="token comment">#q.join()#ä¼šç›´æ¥åœ¨è¿™é‡Œå¡ä½ä¸åŠ¨,ç­‰é˜Ÿåˆ—æ¸…ç©ºå¹¶ä¸”task_downå‘å‡ºæ‰ä¼šæ‰§è¡Œ</span>
    <span class="token comment"># å¯ä»¥é…åˆempty full åˆ¤æ–­æ˜¯ä¸æ˜¯æ¶ˆè´¹æˆ–è€…ç”Ÿäº§ç»“æŸ</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;--------åˆ†å‰²----------&quot;</span>    <span class="token punctuation">)</span>

    <span class="token comment">#ä¼˜å…ˆçº§é˜Ÿå­˜å‚¨ä¸€ä¸ªå…ƒç»„,æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</span>
    <span class="token keyword">from</span> random <span class="token keyword">import</span> randint
    q<span class="token operator">=</span>PriorityQueue<span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token comment">#maxsizeåŒä¸Š</span>
    <span class="token keyword">for</span> p <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#éšæœºç”Ÿæˆæ•°å­—å’Œå­—æ¯çš„åˆ—è¡¨è¡¨è¾¾å¼</span>
        q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è·å–é˜Ÿåˆ—çš„é•¿åº¦</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#é˜Ÿåˆ—æ˜¯ç©ºçš„å—</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>full<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#é˜Ÿåˆ—æ˜¯æ»¡çš„å—</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>join()ä¼šæš‚æ—¶æŒ‚èµ·é˜Ÿåˆ—å’Œå¦„å›¾æ³¨å…¥é˜Ÿåˆ—çš„çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—æ¸…ç©º<br>æ¯å¨¶ä¸€ä¸ªå°±è¦æ‰§è¡Œtask_down()å¦åˆ™ä»–ä¸çŸ¥é“è¿™ä¸ªé˜Ÿåˆ—å·²ç»ç©ºäº†å°±ä¼šä¸€ç›´æŒ‚ç€ã€‚ã€‚ã€‚
å°±æ˜¯ç”¨joinçš„æ—¶å€™å°±ä¸€å®šè¦æ¯æ¬¡å–å®Œtask_downä¸€ä¸‹</p> <h3 id="çº¿ç¨‹é”"><a href="#çº¿ç¨‹é”" aria-hidden="true" class="header-anchor">#</a> çº¿ç¨‹é”</h3> <p>é”è¦å°å¿ƒä½¿ç”¨<br>
å‡è®¾å¾—åˆ°aï¼Œbæ‰èƒ½è¿è¡Œ<br>
çº¿ç¨‹Aå¾—åˆ°äº†b,Bå¾—åˆ°äº†A<br>
ABéƒ½ä¸èƒ½è¿è¡Œ<br></p> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>é”é‡Œåœ¨è·å¾—é”ä¼šæ­»é”<br>
æ³¨æ„é”åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è·å¾—æ‰§è¡Œé‡Šæ”¾ä¹‹åå…¶ä»–çº¿ç¨‹æ‰ä¼šä½¿ç”¨</p></div> <p>é”ä½¿ç”¨ä»£ç å¦‚ä¸‹</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/19 15:58&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Lock<span class="token punctuation">,</span>RLock<span class="token comment">#å¼•å…¥é”</span>
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread
<span class="token comment">#your class&amp;function here</span>
a <span class="token operator">=</span> <span class="token number">0</span>
lock<span class="token operator">=</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>
rLock<span class="token operator">=</span>RLock<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">add1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> a
    <span class="token keyword">global</span> lock
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        lock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#è·å¾—é”</span>
        a <span class="token operator">+=</span> <span class="token number">1</span>
        lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#é‡Šæ”¾é”</span>

<span class="token keyword">def</span> <span class="token function">sub1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> a
    <span class="token keyword">global</span> rLock
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        rLock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#åœ¨ä¸€ä¸ªçº¿ç¨‹å†…å¯é‡å¤è·å¾—çš„é”</span>
        rLock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#é‡å¤è·å¾—</span>
        a <span class="token operator">-=</span> <span class="token number">1</span>
        rLock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#ä¸€å®šè¦æœ‰å¯¹åº”æ¬¡æ•°çš„é‡Šæ”¾</span>
        rLock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    t1<span class="token operator">=</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>add1<span class="token punctuation">)</span>
    t2<span class="token operator">=</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>sub1<span class="token punctuation">)</span>
    t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t2<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token comment">#å¦‚æœå»æ‰é”çš„è¯ç»“æœaä¼šä¹±</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">äº§ç”Ÿæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ï¼š</p> <p>ï¼ˆ1ï¼‰ äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚</p> <p>ï¼ˆ2ï¼‰ è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚</p> <p>ï¼ˆ3ï¼‰ ä¸å‰¥å¤ºæ¡ä»¶:è¿›ç¨‹å·²è·å¾—çš„èµ„æºï¼Œåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å¼ºè¡Œå‰¥å¤ºã€‚</p> <p>ï¼ˆ4ï¼‰ å¾ªç¯ç­‰å¾…æ¡ä»¶:è‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ã€‚</p></div> <h3 id="æ¡ä»¶å˜é‡"><a href="#æ¡ä»¶å˜é‡" aria-hidden="true" class="header-anchor">#</a> æ¡ä»¶å˜é‡</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/19 16:29&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span>Condition

<span class="token comment">#your class&amp;function here</span>
<span class="token keyword">class</span> <span class="token class-name">TianMao</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>cond<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cond <span class="token operator">=</span> cond

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#è·å¾—</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å¤©çŒ«:1&quot;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#ä¼šå‘é€ä¸€ä¸ªä¿¡å·</span>
        self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æ²¡æ”¶åˆ°ä¿¡å·ä¹‹å‰ä¼šé˜»å¡</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å¤©çŒ«:3&quot;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#ä¼šå‘é€ä¸€ä¸ªä¿¡å·</span>
        self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æ²¡æ”¶åˆ°ä¿¡å·ä¹‹å‰ä¼šé˜»å¡</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å¤©çŒ«:5&quot;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#ä¼šå‘é€ä¸€ä¸ªä¿¡å·</span>
        self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æ²¡æ”¶åˆ°ä¿¡å·ä¹‹å‰ä¼šé˜»å¡</span>

        self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#ä¸€å®šè®°å¾—é‡Šæ”¾æ‰</span>


<span class="token keyword">class</span> <span class="token class-name">XiaoAi</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>cond<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cond<span class="token operator">=</span>cond

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#å’Œå¤©çŒ«çš„è°ƒç”¨ä¸€æ ·ï¼Œä¸¤ç§è°ƒç”¨æ–¹å¼</span>
        <span class="token keyword">with</span> self<span class="token punctuation">.</span>cond<span class="token punctuation">:</span><span class="token comment">#with å¥½ç”¨</span>

            self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å°çˆ±:2&quot;</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span>

            self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å°çˆ±:4&quot;</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span>

            self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å°çˆ±:6&quot;</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>cond<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    cond<span class="token operator">=</span>Condition<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t <span class="token operator">=</span> TianMao<span class="token punctuation">(</span>cond<span class="token punctuation">)</span>
    x <span class="token operator">=</span> XiaoAi<span class="token punctuation">(</span>cond<span class="token punctuation">)</span>
    x<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">æç¤º</p> <p>å¯åŠ¨é¡ºåºå¾ˆé‡è¦,å¦‚æœnotifyå…ˆå¯åŠ¨äº†é‚£ä¹ˆæ²¡æœ‰waitçš„çº¿ç¨‹å°±ä¼šå¡ä½<br>
with cond/acquire ä¹‹åæ‰èƒ½ä½¿ç”¨waitå’Œnotify<br>
conditionåŸç†æ˜¯ä¸¤å±‚é”ï¼Œåº•å±‚é”åœ¨çº¿ç¨‹è°ƒç”¨äº†waitçš„æ—¶å€™é‡Šæ”¾ï¼Œä¸Šé¢çš„é”åœ¨æ¯æ¬¡waitçš„æ—¶å€™åˆ†é…ä¸€æŠŠæ”¾åˆ°condçš„ç­‰å¾…é˜Ÿåˆ—ä¸­å»ï¼Œç­‰notifyçš„å”¤é†’<br></p></div> <h3 id="ä¿¡å·é‡"><a href="#ä¿¡å·é‡" aria-hidden="true" class="header-anchor">#</a> ä¿¡å·é‡</h3> <p>å’Œé”ä¸€æ ·ç”¨,å¯ä»¥ä¸ç”¨åŒä¸€ä¸ªå‡½æ•°æ¥é‡Šæ”¾ï¼Œå¯ä»¥è°ƒç”¨å¤šä¸ª<br>
æ˜¯ä¸ªå…¨å±€å¯¹è±¡<br>
å®šä¹‰nä¸ªä¿¡å·é‡ï¼Œæ¯æ¬¡qcquireå°±-1ï¼Œæ¯æ¬¡releaseå°±+1å‡åˆ°äº†0 å°±ä¼šé”ä½<br></p> <p>ä½¿ç”¨ä»£ç å¦‚ä¸‹</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/19 17:10&quot;</span>

<span class="token comment">#import your model here</span>

<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span>Semaphore
<span class="token keyword">import</span> time
<span class="token comment">#your class&amp;function here</span>
<span class="token keyword">class</span> <span class="token class-name">consumer</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>sem<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>sem<span class="token operator">=</span>sem

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;eat!&quot;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>sem<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">producer</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sem<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>sem <span class="token operator">=</span> sem

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>sem<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;make!&quot;</span><span class="token punctuation">)</span>
        consumer<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sem<span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    sem<span class="token operator">=</span>Semaphore<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        p<span class="token operator">=</span>producer<span class="token punctuation">(</span>sem<span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><pre><code>make!make!

make!
eat!eat!eat!

make!
make!make!


eat!
eat!
make!
make!
eat!
make!
eat!
eat!
make!
make!eat!

make!
eat!eat!

make!
make!
eat!
make!
eat!
eat!
make!
make!
eat!
make!
eat!eat!
make!

make!
eat!
eat!
eat!
</code></pre> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>ç¨‹åºç»“æ„åŸºæœ¬å°±æ˜¯ä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹æ‹‰èµ·ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œæ¶ˆè´¹è€…æ¶ˆè´¹å®Œäº†æ‰ä¼šé‡Šæ”¾ä¿¡å·é‡</p></div> <h3 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " aria-hidden="true" class="header-anchor">#</a> çº¿ç¨‹æ± </h3> <p>å¯¹çº¿ç¨‹è¿›è¡Œç®¡ç†ï¼Œè°ƒç”¨çº¿ç¨‹çŠ¶æ€ï¼Œè·å–çº¿ç¨‹è¿”å›å€¼ï¼Œè¿›è¡Œæ± åŒ–ç®¡ç†<br>
å­çº¿ç¨‹å®Œæˆä¹‹åä¸»çº¿ç¨‹èƒ½å¤Ÿç«‹å³çŸ¥é“
ä»£ç å¦‚ä¸‹</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/19 18:57&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor<span class="token punctuation">,</span>as_completed<span class="token punctuation">,</span>wait<span class="token punctuation">,</span>ALL_COMPLETED

<span class="token keyword">import</span> time
<span class="token comment">#your class&amp;function here</span>
<span class="token keyword">def</span> <span class="token function">go</span><span class="token punctuation">(</span>times<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>times<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{}is done&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>times<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token string">&quot;it is {} done&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>times<span class="token punctuation">)</span><span class="token comment">#å‡½æ•°æœ‰è¿”å›å€¼</span>


executor<span class="token operator">=</span>ThreadPoolExecutor<span class="token punctuation">(</span>max_workers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">#nä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œ</span>

task1<span class="token operator">=</span>executor<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>go<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#æäº¤ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡åˆ°æ± ä¸­ï¼Œæ± ä¸­å¯ä»¥æ”¾æ— æ•°ä¸ªï¼Œä½†æ˜¯åªèƒ½åŒæ—¶æ‰§è¡Œmax_workersä¸ª</span>
task2<span class="token operator">=</span>executor<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>go<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#submitæäº¤äº†ä¹‹åä¼šç«‹å³æ‰§è¡Œï¼Œé™„å¸¦äº†executeäº†</span>
<span class="token comment">#taskæ˜¯ä¸€ä¸ªfutureå¯¹è±¡</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>task2<span class="token punctuation">.</span>done<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è·å–å‡½æ•°æ˜¯å¦æ‰§è¡Œå®Œäº†ã€‚</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å–æ¶ˆ1æˆåŠŸäº†å—&quot;</span><span class="token punctuation">,</span>task1<span class="token punctuation">.</span>cancel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å°è¯•å–æ¶ˆä¸€ä¸ªçº¿ç¨‹ï¼Œå–æ¶ˆæˆåŠŸTureï¼Œå¦åˆ™False</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å–æ¶ˆ2æˆåŠŸäº†å—&quot;</span><span class="token punctuation">,</span>task2<span class="token punctuation">.</span>cancel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å®Œæˆäº†çš„çº¿ç¨‹æ— æ³•å–æ¶ˆï¼Œæœªå®Œæˆå·²ç»åœ¨æ± ä¸­çš„å¯ä»¥å–æ¶ˆ</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>task1<span class="token punctuation">.</span>result<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è·å–æ‰§è¡Œå®Œä¹‹åçš„è¿”å›ç»“æœ</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>task2<span class="token punctuation">.</span>done<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">#ç©·ä¸¾æ˜¯æ¯”è¾ƒä½çº§çš„åšæ³•</span>
    t<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span>
    all_task<span class="token operator">=</span><span class="token punctuation">[</span>executor<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>go<span class="token punctuation">,</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> t<span class="token punctuation">]</span><span class="token comment">#è¿­ä»£æ”¾è¿›ä¸€ä¸ªçº¿ç¨‹æ± </span>
    <span class="token keyword">for</span> future <span class="token keyword">in</span> as_completed<span class="token punctuation">(</span>all_task<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#å…è®¸å¼‚æ­¥çš„ç­‰ä»£çº¿ç¨‹æ± ä¸­å®Œæˆçš„çº¿ç¨‹å¹¶å–å›ç»“æœ</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>future<span class="token punctuation">.</span>result<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#è°å…ˆåšå®Œå–å›è°</span>

    wait<span class="token punctuation">(</span>all_task<span class="token punctuation">,</span>return_when<span class="token operator">=</span>ALL_COMPLETED<span class="token punctuation">)</span><span class="token comment">#ç­‰all_taskå…¨æ‰§è¡Œå®Œæ‰æ‰§è¡Œmainçº¿ç¨‹</span>
    <span class="token triple-quoted-string string">'''
    FIRST_COMPLETED = 'FIRST_COMPLETED'
    FIRST_EXCEPTION = 'FIRST_EXCEPTION'
    ALL_COMPLETED = 'ALL_COMPLETED'
    _AS_COMPLETED = '_AS_COMPLETED'
    å¯ä»¥å–ä¸Šé¢çš„å€¼
    '''</span>

    <span class="token comment">#ä½¿ç”¨map</span>
    <span class="token keyword">for</span> future <span class="token keyword">in</span> executor<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>go<span class="token punctuation">,</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#å’Œmapæ˜¯ä¸€ä¸ªé“ç† æ˜ å°„</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>future<span class="token punctuation">)</span><span class="token comment">#ç›´æ¥å¯ä»¥æ‰“å°ç»“æœå“¦ï¼Œè¿”å›é¡ºåºå’Œurlçš„é¡ºåºä¸€è‡´</span>
</code></pre></div><h2 id="å¤šè¿›ç¨‹"><a href="#å¤šè¿›ç¨‹" aria-hidden="true" class="header-anchor">#</a> å¤šè¿›ç¨‹</h2> <p><a href>æ“ä½œç³»ç»Ÿ-è¿›ç¨‹</a>
è¿›ç¨‹ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå˜é‡ç©ºé—´æŒ‰ä¸èƒ½å…±äº«ï¼Œå„è¿›ç¨‹ä¿ç•™ä¸€ä»½ä»£ç å‰¯æœ¬å’Œè¿è¡Œå †æ ˆéœ€è¦ç”¨ç‰¹æ®Šçš„æ•°æ®ç»“æ„æ¥è®¿é—®<br></p> <div class="tip custom-block"><p class="custom-block-title">windows å’Œ linux</p> <p>linuxä¸‹å­è¿›ç¨‹æ°¸è¿œè¿”å›0ï¼Œè€Œçˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹çš„IDã€‚è¿™æ ·åšçš„ç†ç”±æ˜¯ï¼Œä¸€ä¸ªçˆ¶è¿›ç¨‹å¯ä»¥forkå‡ºå¾ˆå¤šå­è¿›ç¨‹ï¼Œæ‰€ä»¥ï¼Œçˆ¶è¿›ç¨‹è¦è®°ä¸‹æ¯ä¸ªå­è¿›ç¨‹çš„IDï¼Œè€Œå­è¿›ç¨‹åªéœ€è¦è°ƒç”¨getppid()å°±å¯ä»¥æ‹¿åˆ°çˆ¶è¿›ç¨‹çš„IDã€‚<br></p></div> <h3 id="è¿›ç¨‹æ± "><a href="#è¿›ç¨‹æ± " aria-hidden="true" class="header-anchor">#</a> è¿›ç¨‹æ± </h3> <p>ProcessPoolExecutor ä»£æ›¿ThreadPoolExecutorå°±å¯ä»¥äº†ï¼Œæ¥å£å½¢çŠ¶ä¸€æ ·<br>
ä»£ç å¦‚ä¸‹</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/19 20:07&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">import</span> multiprocessing

<span class="token comment">#your class&amp;function here</span>
<span class="token keyword">def</span> <span class="token function">go</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;it seems like &quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token string">&quot;it is {} done &quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
   p<span class="token operator">=</span>multiprocessing<span class="token punctuation">.</span>Process<span class="token punctuation">(</span>target<span class="token operator">=</span>go<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token comment">#æ²¡å¯åŠ¨çš„æ—¶å€™ä¸ºNone</span>
   p<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token comment">#å¯åŠ¨äº†è¿”å›pid</span>
   p<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">#ä½¿ç”¨æ± </span>
   pool<span class="token operator">=</span>multiprocessing<span class="token punctuation">.</span>Pool<span class="token punctuation">(</span>multiprocessing<span class="token punctuation">.</span>cpu_count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#ä¼ å…¥workeræ•°é‡é»˜è®¤ä¸ºcpuæ ¸æ•°é‡</span>
   result<span class="token operator">=</span>pool<span class="token punctuation">.</span>apply_async<span class="token punctuation">(</span>go<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å’Œcommitä¸€ä¸ªä½œç”¨ç›´æ¥ä¼ è¿›å»</span>

   pool<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#ä¸å†æ¥å—æ–°çš„è¿›ç¨‹ä»»åŠ¡</span>
   pool<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#å¯ä»¥ä¸€æ¬¡æ€§å°†æ± ä¸­çš„è¿›ç¨‹éƒ½é˜»å¡</span>
   <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

   <span class="token keyword">for</span> result <span class="token keyword">in</span> pool<span class="token punctuation">.</span>imap<span class="token punctuation">(</span>go<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#å¼‚æ­¥è¿”å›ç»“æœï¼Œä¸€æ¬¡æ€§æäº¤</span>
       <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

   <span class="token keyword">for</span> result <span class="token keyword">in</span> pool<span class="token punctuation">.</span>imap_unordered<span class="token punctuation">(</span>go<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#å¼‚æ­¥è¿”å›ç»“æœï¼Œä¸€æ¬¡æ€§æäº¤ï¼Œæ— åº</span>
       <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre></div><h3 id="è¿›ç¨‹ä¹‹é—´é€šä¿¡"><a href="#è¿›ç¨‹ä¹‹é—´é€šä¿¡" aria-hidden="true" class="header-anchor">#</a> è¿›ç¨‹ä¹‹é—´é€šä¿¡</h3> <ul><li>Queue.qsize()ï¼šè¿”å›å½“å‰é˜Ÿåˆ—åŒ…å«çš„æ¶ˆæ¯æ•°é‡ï¼›</li> <li>Queue.empty()ï¼šå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›Trueï¼Œåä¹‹False ï¼›</li> <li>Queue.full()ï¼šå¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œè¿”å›True,åä¹‹Falseï¼›</li> <li>Queue.get():è·å–é˜Ÿåˆ—ä¸­çš„ä¸€æ¡æ¶ˆæ¯ï¼Œç„¶åå°†å…¶ä»åˆ—é˜Ÿä¸­ç§»é™¤ï¼Œå¯ä¼ å‚è¶…æ—¶æ—¶é•¿ã€‚</li> <li>Queue.get_nowait()ï¼šç›¸å½“Queue.get(False),å–ä¸åˆ°å€¼æ—¶è§¦å‘å¼‚å¸¸ï¼šEmptyï¼›</li> <li>Queue.put():å°†ä¸€ä¸ªå€¼æ·»åŠ è¿›æ•°åˆ—ï¼Œå¯ä¼ å‚è¶…æ—¶æ—¶é•¿ã€‚</li> <li>Queue.put_nowait():ç›¸å½“äºQueue.get(False),å½“é˜Ÿåˆ—æ»¡äº†æ—¶æŠ¥é”™ï¼šFullã€‚</li></ul> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>windowsä¸‹æ‰€æœ‰å…³äºè¿›ç¨‹çš„æ“ä½œéƒ½è¦æ”¾åœ¨if <strong>name</strong> == '<strong>main</strong>':ä¸‹é¢è¿›è¡Œï¼Œå¦åˆ™ä¼šæŠ¥é”™
åœ¨ä½¿ç”¨è¿›ç¨‹æ± çš„æ—¶å€™å¿…é¡»ç”¨Manager()å¯¹è±¡çš„Queueä¸ç„¶ä¼šå‡ºé”™</p></div> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">import</span> multiprocessing
<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Queue<span class="token punctuation">,</span>Pipe<span class="token punctuation">,</span>Manager<span class="token punctuation">,</span>Lock<span class="token punctuation">,</span>Process
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">putit</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    q<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'aaa'</span>
    <span class="token comment">#q.put([1,2,3])</span>
    <span class="token comment">#print(q.qsize())</span>

<span class="token keyword">def</span> <span class="token function">getit</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">#print(q.get())</span>
    <span class="token comment">#print(q.qsize())</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    Q <span class="token operator">=</span> Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åœ¨ä½¿ç”¨è¿›ç¨‹æ± çš„æ—¶å€™ï¼Œä¼šå‡ºé”™ï¼Œä½¿ç”¨manage.Queue()</span>
    P <span class="token operator">=</span> Pipe<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®ä¸ºFalseå°±æ˜¯å•å‘é˜Ÿåˆ—</span>
    M <span class="token operator">=</span> Manager<span class="token punctuation">(</span><span class="token punctuation">)</span>
    D <span class="token operator">=</span> M<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    MQ <span class="token operator">=</span> M<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># a = Process(target=putit, args=(Q,))</span>
    <span class="token comment"># b = Process(target=getit, args=(Q,))</span>
    a <span class="token operator">=</span> Process<span class="token punctuation">(</span>target<span class="token operator">=</span>putit<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>D<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> Process<span class="token punctuation">(</span>target<span class="token operator">=</span>getit<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>D<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    a<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    b<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    a<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
    b<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>å¤æ‚çš„æ•°æ®å¯¹è±¡ç”¨M.dictï¼Œç®€å•çš„ç”¨listï¼Œæ‰€æœ‰çš„æ•°æ®ç»“æ„å»æºç é‡Œçœ‹çœ‹</p> <h2 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" aria-hidden="true" class="header-anchor">#</a> å¼‚æ­¥</h2> <h3 id="å¼‚æ­¥åŸºæœ¬æ¦‚å¿µ"><a href="#å¼‚æ­¥åŸºæœ¬æ¦‚å¿µ" aria-hidden="true" class="header-anchor">#</a> å¼‚æ­¥åŸºæœ¬æ¦‚å¿µ</h3> <h4 id="å¹¶å‘-å¹¶è¡Œ-é˜»å¡-éé˜»å¡-åŒæ­¥-å¼‚æ­¥"><a href="#å¹¶å‘-å¹¶è¡Œ-é˜»å¡-éé˜»å¡-åŒæ­¥-å¼‚æ­¥" aria-hidden="true" class="header-anchor">#</a> å¹¶å‘ å¹¶è¡Œ é˜»å¡ éé˜»å¡ åŒæ­¥ å¼‚æ­¥<br></h4> <ol><li><strong>å¹¶å‘</strong> åœ¨æŸä¸€æ—¶é—´æ®µå†…æœ‰å¤šä¸ªç¨‹åºè¿è¡Œåœ¨ä¸€ä¸ªcpuä¸Š<br></li> <li><strong>å¹¶è¡Œ</strong> åœ¨æŸä¸€æ—¶åˆ»æœ‰å¤šä¸ªç¨‹åºè¿è¡Œåœ¨å¤šä¸ªcpuä¸Š<br></li> <li><strong>é˜»å¡</strong> è°ƒç”¨å‡½æ•°æ—¶å½“å‰å‡½æ•°è¢«æŒ‚èµ·<br></li> <li><strong>éé˜»å¡</strong>è°ƒç”¨å‡½æ•°çº¿ç¨‹ä¸ä¼šè¢«æŒ‚èµ·ä¼šç«‹å³è¿”å›<br></li> <li><strong>åŒæ­¥IO</strong> å‘å‡ºè¯·æ±‚ä¹‹åç­‰å¾…ç»“æœ<br></li> <li><strong>å¼‚æ­¥IO</strong> å‘å‡ºè¯·æ±‚ä¹‹åç«‹å³è¿”å›ï¼Œä¸ç­‰å¾…ç»“æœuinxä¸‹äº”ç§IOæ¨¡å‹
<ul><li>é˜»å¡å¼IO</li> <li>éé˜»å¡å¼IO</li> <li>IOå¤šè·¯å¤ç”¨</li> <li>å¼‚æ­¥IOï¼ˆåç¨‹ï¼‰</li> <li>ä¿¡å·é©±åŠ¨å¼IOï¼ˆç”¨çš„å°‘ï¼‰selectã€pollã€epoll</li></ul></li></ol> <h3 id="ä¸‰ç§å¼‚æ­¥æœºåˆ¶"><a href="#ä¸‰ç§å¼‚æ­¥æœºåˆ¶" aria-hidden="true" class="header-anchor">#</a> ä¸‰ç§å¼‚æ­¥æœºåˆ¶</h3> <div class="danger custom-block"><p class="custom-block-title">ç•™å‘</p> <p>éœ€è¦èŠ±æ—¶é—´å¥½å¥½æ•´ç†</p></div> <p>select, poll , epolléƒ½æ˜¯Iã€‡å¤šè·¯å¤ç”¨çš„æœºåˆ¶ã€‚I/Oå¤šè·¯å¤ç”¨å°±æ˜¯é€šè¿‡ä¸€ç§æœº
åˆ¶ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç›‘è§†å¤šä¸ªæè¿°ç¬¦ï¼Œä¸€æ—¦æŸä¸ªæè¿°ç¬¦å°±ç»ªï¼ˆä¸€èˆ¬æ˜¯è¯»å°±ç»ªæˆ–
è€…å†™å°±ç»ªï¼‰ï¼Œèƒ½å¤Ÿé€šçŸ¥ç¨‹åºè¿›è¡Œç›¸åº”çš„è¯»å†™æ“ä½œã€‚ä½†select, poll , epollæœ¬
è´¨ä¸Šéƒ½æ˜¯åŒæ­¥I/O ,å› ä¸ºä»–ä»¬éƒ½éœ€è¦åœ¨è¯»å†™äº‹ä»¶å°±ç»ªåè‡ªå·±è´Ÿè´£è¿›è¡Œè¯»å†™ï¼Œ
ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¯»å†™è¿‡ç¨‹æ˜¯é˜»å¡çš„ï¼Œè€Œå¼‚æ­¥I/Oåˆ™æ— éœ€è‡ªå·±è´Ÿè´£è¿›è¡Œè¯»å†™ï¼Œå¼‚
æ­¥I/Oçš„å®ç°ä¼šè´Ÿè´£æŠŠæ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚select</p> <p>selectå‡½æ•°ç›‘è§†çš„æ–‡ä»¶æè¿°ç¬¦åˆ†3ç±»ï¼Œåˆ†åˆ«æ˜¯writefdsã€readfdsã€å’Œ
exceptfdsã€‚è°ƒç”¨åselectå‡½æ•°ä¼šé˜»å¡ï¼Œç›´åˆ°æœ‰æè¿°å‰¯å°±ç»ªï¼ˆæœ‰æ•°æ®å¯è¯»ã€
å¯å†™ã€æˆ–è€…æœ‰except),æˆ–è€…è¶…æ—¶ï¼ˆtimeoutæŒ‡å®šç­‰å¾…æ—¶é—´ï¼Œå¦‚æœç«‹å³è¿”å›
è®¾ä¸ºnullå³å¯ï¼‰ï¼Œå‡½æ•°è¿”å›ã€‚å½“selectå‡½æ•°è¿”å›åï¼Œå¯ä»¥é€šè¿‡éå†fdset,æ¥
æ‰¾åˆ°å°±ç»ªçš„æè¿°ç¬¦ã€‚</p> <p>selectç›®å‰å‡ ä¹åœ¨æ‰€æœ‰çš„å¹³å°ä¸Šæ”¯æŒï¼Œå…¶è‰¯å¥½è·¨å¹³å°æ”¯æŒä¹Ÿæ˜¯å®ƒçš„ä¸€ä¸ª
ä¼˜ç‚¹ã€‚selecå•²ä¸€ä¸ªç¼ºç‚¹åœ¨äºå•ä¸ªè¿›ç¨‹èƒ½å¤Ÿç›‘è§†çš„æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡å­˜åœ¨æœ€
å¤§é™åˆ¶ï¼Œåœ¨Linuxä¸Šä¸€èˆ¬ä¸º1024 ,å¯ä»¥é€šè¿‡ä¿®æ”¹å®å®šä¹‰ç”šè‡³é‡æ–°ç¼–è¯‘å†…æ ¸çš„
æ–¹å¼æå‡è¿™ä¸€é™åˆ¶ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿä¼šé€ æˆæ•ˆç‡çš„é™ä½ã€‚poll</p> <p>ä¸åŒä¸selectä½¿ç”¨ä¸‰ä¸ªä½å›¾æ¥è¡¨ç¤ºä¸‰ä¸ªfdsetçš„æ–¹å¼ï¼Œpollä½¿ç”¨ä¸€ä¸ª
pollfdçš„æŒ‡é’ˆå®ç°ã€‚</p> <p>pollfdç»“æ„åŒ…å«äº†è¦Sè§çš„eventå’Œå‘ç”Ÿçš„event,ä¸å†ä½¿ç”¨select &quot;å‚
æ•°-å¡«ã€ƒä¼ é€’çš„æ–¹å¼ã€‚åŒæ—¶ï¼ŒpoNfdå¹¶æ²¡æœ‰æœ€å¤§æ•°é‡é™åˆ¶ï¼ˆä½†æ˜¯æ•°é‡è¿‡å¤§å
æ€§èƒ½ä¹Ÿæ˜¯ä¼šä¸‹é™ï¼‰ã€‚å’Œselectå‡½æ•°_æ ·ï¼Œpollè¿”å›åï¼Œéœ€è¦è½®è¯¢pollfdæ¥è·
å–å°±ç»ªçš„æè¿°ç¬¦ã€‚</p> <p>ä»ä¸Šé¢çœ‹ï¼Œselectå’Œpolléƒ½éœ€è¦åœ¨è¿”å›åï¼Œé€šè¿‡éå†æ–‡ä»¶æè¿°ç¬¦æ¥è·å–
å·²ç»å°±ç»ªçš„socketã€‚äº‹å®ä¸Šï¼ŒåŒæ—¶è¿æ¥çš„å¤§é‡å®¢æˆ·ç«¯åœ¨ä¸€æ—¶åˆ»å¯èƒ½åªæœ‰å¾ˆå°‘
çš„å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå› æ­¤éšç€ç›‘è§†çš„æè¿°ç¬¦æ•°é‡çš„å¢é•¿ï¼Œå…¶æ•ˆç‡ä¹Ÿä¼šçº¿æ€§ä¸‹é™epoll
linuxæ”¯æŒï¼Œwindowsä¸æ”¯æŒ
epollæ˜¯åœ¨2.6å†…æ ¸ä¸­æå‡ºçš„ï¼Œæ˜¯ä¹‹å‰çš„selectå’Œpollçš„å¢å¼ºç‰ˆæœ¬ã€‚
ç›¸å¯¹äºselectå’Œpollæ¥è¯´ï¼Œepolæ›´åŠ çµæ´»ï¼Œæ²¡æœ‰æè¿°ç¬¦é™åˆ¶ã€‚
epollä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ç®¡ç†å¤šä¸ªæè¿°ç¬¦ï¼Œ
å°†ç”¨æˆ·å…³ç³»çš„æ–‡ä»¶æè¿°ç¬¦çš„äº‹ä»¶å­˜æ”¾åˆ°å†…æ ¸çš„ä¸€ä¸ªäº‹ä»¶è¡¨ä¸­ï¼Œè¿™æ ·åœ¨ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„copyåªéœ€ä¸€æ¬¡ã€‚
ä»£ç </p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/21 19:29&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> time
<span class="token keyword">from</span> functools <span class="token keyword">import</span> partial
<span class="token comment">#your class&amp;function here</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">gethtml</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;start &quot;</span><span class="token operator">+</span>html<span class="token punctuation">)</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">#å¼‚æ­¥ç­‰å¾…</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'end '</span><span class="token operator">+</span>html<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">&quot;çªåšå®Œäº†&quot;</span>

<span class="token keyword">def</span> <span class="token function">callback</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span>future<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#ä½¿ç”¨partialæ—¶å‚æ•°å¿…é¡»æŒ‰é¡ºåºæ‘†æ”¾ï¼Œè°ƒç”¨æ—¶æ˜¯å…ˆä¼ å…¥çš„åœ°å€ï¼Œloopåˆç»™çš„future</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;I have send it to &quot;</span><span class="token punctuation">,</span>address<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    start_time<span class="token operator">=</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    loop<span class="token operator">=</span>asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#åˆ›å»ºä¸€ä¸ªåç¨‹æ± </span>
    loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>gethtml<span class="token punctuation">(</span><span class="token string">&quot;a.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#åŸºæœ¬ç”¨æ³•ï¼Œæäº¤ä¸€ä¸ªåç¨‹å¯¹è±¡ç«‹å³å¼‚æ­¥è¿è¡Œ</span>

<span class="token comment">#ä½¿ç”¨future</span>

    get_future<span class="token operator">=</span>asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span>gethtml<span class="token punctuation">(</span><span class="token string">&quot;b.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å’Œloop.create_taskçš„æ–¹æ³•ä½œç”¨ä¸€æ ·ï¼Œè¿”å›ä¸€ä¸ªfutureå¯¹è±¡,å‚è€ƒsubmitï¼ŒæŠŠåç¨‹å¯¹è±¡æ”¾è¿›å»</span>
    loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>get_future<span class="token punctuation">)</span><span class="token comment">#ä¼ å…¥åç¨‹futureå¹¶è¿è¡Œï¼Œä¼šç›´æ¥å¯¹åŸå…ˆçš„é˜Ÿåˆ—åšæ“ä½œ</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>get_future<span class="token punctuation">.</span>result<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#æ‰“å°å¤„ç†å®Œçš„è¿”å›å€¼</span>

<span class="token comment"># ä½¿ç”¨taskï¼Œå¯ä»¥æ·»åŠ å›è°ƒ</span>

    task <span class="token operator">=</span> loop<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>gethtml<span class="token punctuation">(</span><span class="token string">&quot;c.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># taskå’Œfutureä¸€æ ·ï¼Œæ˜¯futureçš„å­ç±»</span>
    task<span class="token punctuation">.</span>add_done_callback<span class="token punctuation">(</span>partial<span class="token punctuation">(</span>callback<span class="token punctuation">,</span><span class="token string">&quot;576359186@qq.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å¤ªéš¾å«ä¸€ä¸ªå›è°ƒ,åœ¨ä»»åŠ¡å®Œæˆæ—¶å°±ä¼šè°ƒç”¨ï¼Œä¼šè‡ªåŠ¨å‘callbackä¼ å…¥ä¸€ä¸ªå®Œæˆäº†çš„future</span>
    loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>task<span class="token punctuation">)</span>  <span class="token comment"># ä¼ å…¥åç¨‹futureå¹¶è¿è¡Œï¼Œä¼šç›´æ¥å¯¹åŸå…ˆçš„é˜Ÿåˆ—åšæ“ä½œ</span>
    <span class="token comment">#partialå‡½æ•°ç”¨äºæŠŠï¼ˆå‡½æ•°ï¼Œå‚æ•°ï¼‰åŒ…è£¹èµ·æ¥å½¢æˆä¸€ä¸ªæ–°çš„ï¼ˆå¥æŸ„ï¼‰å¯ä¾›å…¶ä»–å‡½æ•°æ¥æ”¶</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span>result<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°å¤„ç†å®Œçš„è¿”å›å€¼</span>

<span class="token comment">#ä½¿ç”¨ä»»åŠ¡é˜Ÿåˆ—</span>

    tasks<span class="token operator">=</span><span class="token punctuation">[</span>gethtml<span class="token punctuation">(</span><span class="token string">&quot;a.com&quot;</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment">#ä»»åŠ¡åˆ—è¡¨ï¼Œå…¨æ˜¯åç¨‹å¯¹è±¡</span>
    <span class="token comment">#loop.run_until_complete(asyncio.wait(tasks))#ä¼ å…¥asyncio.wait(ä»»åŠ¡åˆ—è¡¨)é»˜è®¤ç›´åˆ°å…¨å®Œæˆæ‰é€€å‡º</span>
    tasks2 <span class="token operator">=</span> <span class="token punctuation">[</span>gethtml<span class="token punctuation">(</span><span class="token string">&quot;a.com&quot;</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    tasks2<span class="token operator">=</span>asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks2<span class="token punctuation">)</span>
    <span class="token comment">#waitæ–¹æ³•å’Œçº¿ç¨‹ä¸­çš„waitæ–¹æ³•ä¸€æ ·ï¼Œä¼šé˜»å¡çº¿ç¨‹ç›´åˆ°æ»¡è¶³returnwhenç„¶åè§¦å‘ä¸€ä¸ªäº‹ä»¶ç»§ç»­è¿›è¡Œ</span>
    loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">,</span>tasks2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">#å¯ä»¥ç›´æ¥task2.cancel()å–æ¶ˆé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡</span>
    <span class="token comment"># gatheræ›´åŠ é«˜å±‚ï¼Œ*taskså¯ä»¥å°†taskä¼ å…¥ï¼Œå¯ä¼ å…¥å¤šä¸ªtaskgroup,æ³¨æ„taskå’Œtask2</span>


    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start_time<span class="token punctuation">)</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">ä½¿ç”¨åœºæ™¯</p> <p>åŒ…å«å„ç§ç‰¹å®šç³»ç»Ÿå®ç°çš„æ¨¡å—åŒ–äº‹ä»¶å¾ªç¯ä¼ è¾“å’Œåè®®æŠ½è±¡<br>
å¯¹TCPã€UDPã€SSLã€å­è¿›ç¨‹ã€å»¶æ—¶è°ƒç”¨ä»¥åŠå…¶ä»–çš„å…·ä½“æ”¯æŒæ¨¡ä»¿futuresæ¨¡å—ä½†é€‚ç”¨äºäº‹ä»¶å¾ªç¯ä½¿ç”¨çš„Futureç±»å‹<br>
åŸºäºyield fromçš„åè®®å’Œä»»åŠ¡ï¼Œå¯ä»¥è®©ä½ ç”¨é¡ºåºçš„æ–¹å¼ç¼–å†™å¹¶å‘ä»£ç å¿…é¡»ä½¿ç”¨ä¸€ä¸ªå°†äº§ç”Ÿé˜»å¡IOçš„è°ƒç”¨æ—¶<br>
æœ‰æ¥å£å¯ä»¥æŠŠè¿™ä¸ªäº‹ä»¶è½¬ç§»åˆ°çº¿ç¨‹æ± è«ä»¿threadingæ¨¡å—ä¸­çš„åŒæ­¥åŸè¯­ã€å¯ä»¥ç”¨åœ¨å•çº¿ç¨‹å†…çš„åç¨‹ä¹‹é—´<br></p></div> <h3 id="asyncioç”Ÿæ€"><a href="#asyncioç”Ÿæ€" aria-hidden="true" class="header-anchor">#</a> asyncioç”Ÿæ€</h3> <p>asyncioå®˜æ–¹åªå®ç°äº†æ¯”è¾ƒåº•å±‚çš„åè®®ï¼Œæ¯”å¦‚TCPï¼ŒUDPã€‚æ‰€ä»¥è¯¸å¦‚HTTPåè®®ä¹‹ç±»éƒ½éœ€è¦å€ŸåŠ©ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚aiohttpã€‚<br></p> <p>è™½ç„¶å¼‚æ­¥ç¼–ç¨‹çš„ç”Ÿæ€ä¸å¤ŸåŒæ­¥ç¼–ç¨‹çš„ç”Ÿæ€é‚£ä¹ˆå¼ºå¤§ï¼Œä½†æ˜¯å¦‚æœåˆé«˜å¹¶å‘çš„éœ€æ±‚ä¸å¦¨è¯•è¯•ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ¯”è¾ƒæˆç†Ÿçš„å¼‚æ­¥åº“</p> <p><a href="https://aiohttp.readthedocs.io/en/stable/">aiohttp</a>
å¼‚æ­¥http client/serveræ¡†æ¶</p> <p><a href="https://sanic.readthedocs.io/en/latest/">sanic</a><br>
é€Ÿåº¦æ›´å¿«çš„ç±»flask webæ¡†æ¶ã€‚<br></p> <p><a href="https://uvloop.readthedocs.io/">uvloop</a>
å¿«é€Ÿï¼Œå†…åµŒäºasyncioäº‹ä»¶å¾ªç¯çš„åº“ï¼Œä½¿ç”¨cythonåŸºäºlibuvå®ç°ã€‚<br>
å®˜æ–¹æ€§èƒ½æµ‹è¯•:<br>
nodejsçš„ä¸¤å€ï¼Œè¿½å¹³golang<br>
ä¸ºäº†å‡å°‘æ­§ä¹‰ï¼Œè¿™é‡Œçš„æ€§èƒ½æµ‹è¯•åº”è¯¥åªæ˜¯ç½‘ç»œIOé«˜å¹¶å‘æ–¹é¢ä¸æ˜¯è¯´ä»»ä½•æ–¹é¢è¿½å¹³golangã€‚<br>
æ‘˜è‡ªå“ªä¸ªåšå®¢æˆ‘ç»™å¿˜äº†,å›å¤´æ‰¾åˆ°äº†å°±æ·»ä¸Š</p> <h3 id="å°æ€»ç»“"><a href="#å°æ€»ç»“" aria-hidden="true" class="header-anchor">#</a> å°æ€»ç»“</h3> <p>Pythonä¹‹æ‰€ä»¥èƒ½å¤Ÿå¤„ç†ç½‘ç»œIOé«˜å¹¶å‘ï¼Œæ˜¯å› ä¸ºå€ŸåŠ©äº†é«˜æ•ˆçš„IOæ¨¡å‹ï¼Œèƒ½å¤Ÿæœ€å¤§é™åº¦çš„è°ƒåº¦IOï¼Œç„¶åäº‹ä»¶å¾ªç¯ä½¿ç”¨åç¨‹å¤„ç†IOï¼Œåç¨‹é‡åˆ°IOæ“ä½œå°±å°†æ§åˆ¶æƒæŠ›å‡ºï¼Œé‚£ä¹ˆåœ¨IOå‡†å¤‡å¥½ä¹‹å‰çš„è¿™æ®µäº‹ä»¶ï¼Œäº‹ä»¶å¾ªç¯å°±å¯ä»¥ä½¿ç”¨å…¶ä»–çš„åç¨‹å¤„ç†å…¶ä»–äº‹æƒ…ï¼Œç„¶ååç¨‹åœ¨ç”¨æˆ·ç©ºé—´ï¼Œå¹¶ä¸”æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ä¸ä¼šåƒå¤šçº¿ç¨‹ï¼Œå¤šè¿›ç¨‹é‚£æ ·é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå› è€Œèƒ½å¤ŸèŠ‚çœå¤§é‡çš„ä¸å¿…è¦æ€§èƒ½æŸå¤±ã€‚<br></p> <div class="warning custom-block"><p class="custom-block-title">æ³¨æ„</p> <p>ä¸è¦å†åç¨‹é‡Œé¢ä½¿ç”¨time.sleepä¹‹ç±»çš„åŒæ­¥æ“ä½œï¼Œå› ä¸ºåç¨‹å†å•çº¿ç¨‹é‡Œé¢ï¼Œæ‰€ä»¥ä¼šä½¿å¾—æ•´ä¸ªçº¿ç¨‹åœä¸‹æ¥ç­‰å¾…ï¼Œä¹Ÿå°±æ²¡æœ‰åç¨‹çš„ä¼˜åŠ¿äº†</p></div> <p>æœ¬æ–‡ä¸»è¦è®²è§£Pythonä¸ºä»€ä¹ˆèƒ½å¤Ÿå¤„ç†é«˜å¹¶å‘,ä¸æ˜¯ä¸ºäº†è®²è§£æŸä¸ªåº“æ€ä¹ˆä½¿ç”¨,æ‰€ä»¥ä½¿ç”¨ç»†èŠ‚è¯·æŸ¥é˜…å®˜æ–¹æ–‡æ¡£æˆ–è€…æ‰§è¡Œã€‚<br></p> <p>æ— è®ºä»€ä¹ˆç¼–ç¨‹è¯­è¨€ï¼Œé«˜æ€§èƒ½æ¡†æ¶ï¼Œä¸€èˆ¬ç”±äº‹ä»¶å¾ªç¯ + é«˜æ€§èƒ½IOæ¨¡å‹(ä¹Ÿè®¸æ˜¯epoll)ç»„æˆ</p> <h3 id="asyncå…³é”®å­—"><a href="#asyncå…³é”®å­—" aria-hidden="true" class="header-anchor">#</a> asyncå…³é”®å­—</h3> <p>å¯ä»¥å¼‚æ­¥çš„å®šä¹‰å‡½æ•°</p> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>ç•™å‘</p></div> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/22 8:18&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> time

<span class="token comment">#your class&amp;function here</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;waiting&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;done after {} seconds&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    tasks<span class="token operator">=</span><span class="token punctuation">[</span>get<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>get<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>get<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    loop<span class="token operator">=</span>asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å¼€å§‹è¿è¡Œä»»åŠ¡</span>
    <span class="token keyword">except</span> KeyboardInterrupt <span class="token keyword">as</span> e<span class="token punctuation">:</span><span class="token comment">#æŒ‰ä¸‹Ctrl+cçš„æ—¶å€™ä¼šè§¦å‘</span>
        all_tasks<span class="token operator">=</span>asyncio<span class="token punctuation">.</span>Task<span class="token punctuation">.</span>all_tasks<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#è·å–æ‰€æœ‰çš„åç¨‹ä»»åŠ¡ï¼Œæ²¡æœ‰ä¼ å…¥ï¼ŒåŒè¿‡eventloopè·å–çš„</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> all_tasks<span class="token punctuation">:</span><span class="token comment">#è¿­ä»£</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;cancel it!&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>cancel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#å–æ¶ˆä»»åŠ¡ï¼ŒæˆåŠŸå°±è¿”å›True</span>
        loop<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#åœæ­¢å¾ªç¯</span>
        loop<span class="token punctuation">.</span>run_forever<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#è°ƒç”¨ï¼Œå¦åˆ™ä¼šå‡ºé”™</span>
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        loop<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æ— è®ºæ€æ ·éƒ½è¦å…³é—­loop</span>
</code></pre></div><h3 id="åµŒå¥—åç¨‹çš„è¿”å›æœºåˆ¶"><a href="#åµŒå¥—åç¨‹çš„è¿”å›æœºåˆ¶" aria-hidden="true" class="header-anchor">#</a> åµŒå¥—åç¨‹çš„è¿”å›æœºåˆ¶</h3> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>ç•™å‘</p></div> <p><img src="https://upload-images.jianshu.io/upload_images/12620393-1c869fc45f491682.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åµŒå¥—åç¨‹çš„è¿”å›æœºåˆ¶"></p> <h3 id="åœ¨å¼‚æ­¥ä¸­ä½¿ç”¨åŒæ­¥ä»£ç "><a href="#åœ¨å¼‚æ­¥ä¸­ä½¿ç”¨åŒæ­¥ä»£ç " aria-hidden="true" class="header-anchor">#</a> åœ¨å¼‚æ­¥ä¸­ä½¿ç”¨åŒæ­¥ä»£ç </h3> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>ç•™å‘</p></div> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#import your model here</span>
<span class="token keyword">import</span> asyncio<span class="token punctuation">,</span>time
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token comment">#your class&amp;function here</span>
<span class="token keyword">def</span> <span class="token function">s</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;sleep &quot;</span><span class="token punctuation">,</span>t<span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
<span class="token comment">#åœ¨å¼‚æ­¥ä¸­ä½¿ç”¨åŒæ­¥ä»£ç </span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    loop<span class="token operator">=</span>asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    executor<span class="token operator">=</span>ThreadPoolExecutor<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token comment">#åˆ›å»ºçº¿ç¨‹æ± </span>
    tasks<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        task<span class="token operator">=</span>loop<span class="token punctuation">.</span>run_in_executor<span class="token punctuation">(</span>executor<span class="token punctuation">,</span>s<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token comment">#ä¼ å…¥è¦æ·»åŠ çš„çº¿ç¨‹æ± ï¼Œè¦è¿è¡Œçš„åŒæ­¥å‡½æ•°ï¼Œå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªtaskå¯¹è±¡</span>
        tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token comment">#æ·»åŠ ä»»åŠ¡åˆ—è¡¨</span>
    loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="å¼‚æ­¥ç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸€äº›å‡½æ•°"><a href="#å¼‚æ­¥ç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸€äº›å‡½æ•°" aria-hidden="true" class="header-anchor">#</a> å¼‚æ­¥ç”Ÿå‘½å‘¨æœŸä¸­çš„ä¸€äº›å‡½æ•°</h3> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>ç•™å‘</p></div> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">callback</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;sleep {} times&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">stoploop</span><span class="token punctuation">(</span>loop<span class="token punctuation">)</span><span class="token punctuation">:</span>
    loop<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    loop<span class="token operator">=</span>asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    now<span class="token operator">=</span>loop<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    loop<span class="token punctuation">.</span>call_later<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>callback<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment">#è¿‡æŒ‡å®šçš„æ—¶é—´å°±ä¼šè¿è¡ŒæŸä¸ªå‡½æ•°ï¼Œå‚æ•°ï¼Œæ ¹æ®æ—¶é—´æ’åˆ—å…ˆåé¡ºåº</span>
    loop<span class="token punctuation">.</span>call_at<span class="token punctuation">(</span>now<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span>callback<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#è¿‡æŒ‡å®šçš„æ—¶é—´å°±ä¼šè¿è¡ŒæŸä¸ªå‡½æ•°ï¼Œå‚æ•°ï¼Œloopä¸­çš„æ—¶é—´</span>
    loop<span class="token punctuation">.</span>call_soon<span class="token punctuation">(</span>callback<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token comment">#ç«‹å³è¿è¡ŒæŸä¸ªå‡½æ•°ï¼Œå‚æ•°ï¼Œä¸ä¼šæŒ‰æ—¶é—´æ’åºä¸€èµ·å¼€å§‹è¿è¡Œ</span>
    loop<span class="token punctuation">.</span>call_soon<span class="token punctuation">(</span>stoploop<span class="token punctuation">,</span>loop<span class="token punctuation">)</span><span class="token comment">#åœæ­¢åç¨‹</span>
    loop<span class="token punctuation">.</span>call_soon_threadsafe<span class="token punctuation">(</span>callback<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token comment">#çº¿ç¨‹å®‰å…¨çš„è¿è¡ŒæŸä¸ªå‡½æ•°</span>
    loop<span class="token punctuation">.</span>run_forever<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#åˆ«å¿˜äº†è¿™ä¸ª</span>
</code></pre></div><h3 id="å¼‚æ­¥ä¸­çš„é”"><a href="#å¼‚æ­¥ä¸­çš„é”" aria-hidden="true" class="header-anchor">#</a> å¼‚æ­¥ä¸­çš„é”</h3> <p>åœ¨å¼‚æ­¥ä¸­å› ä¸ºä»£ç ç‰‡æ‰§è¡Œåˆ°ä¸€å®šæ—¶é—´æˆ–æ‰§è¡Œäº†ä¸€å®šæ ˆå¸§ï¼ŒGILä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œä¹Ÿå¯èƒ½å¯¼è‡´çº¿ç¨‹(å¼‚æ­¥)ä¸å®‰å…¨<br>
å’Œå¤šçº¿ç¨‹ä¸­ä¸€æ ·æˆ‘ä»¬éœ€è¦ä½¿ç”¨é”æ¥ä¿è¯æ•°æ®ä¸€è‡´æ€§</p> <div class="language-python extra-class"><pre class="language-python"><code>lock<span class="token operator">=</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>
cache<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#è¯·æ±‚htmlçš„å‡½æ•°</span>
    <span class="token keyword">global</span> cache
    <span class="token keyword">async</span> <span class="token keyword">with</span> lock<span class="token punctuation">:</span><span class="token comment">#å¯ä»¥acquireä¹Ÿå¯ä»¥ç›´æ¥async with=with await</span>
        <span class="token keyword">if</span> arg <span class="token keyword">in</span> cache<span class="token punctuation">:</span>
            <span class="token keyword">return</span> cache<span class="token punctuation">[</span>arg<span class="token punctuation">]</span>
        <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token comment">#è€—æ—¶æ“ä½œ</span>
        cache<span class="token punctuation">[</span><span class="token string">&quot;arg&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#ä½¿ç”¨è¿™ä¸ªè¯·æ±‚ï¼Œè°ƒç”¨äº†è¿™ä¸ªè§£æå‡½æ•°</span>
    <span class="token keyword">await</span> parse<span class="token punctuation">(</span><span class="token string">&quot;didi&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">reparse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#é‡æ–°è§£æè¿™ä¸ªè¯·æ±‚ï¼Œå†æ¬¡è°ƒç”¨è¿™ä¸ªè§£æå‡½æ•°ï¼Œè¿™æ ·å°±å¯¹ä¸€ä¸ªurlè°ƒç”¨äº†2æ¬¡</span>
    <span class="token keyword">await</span> parse<span class="token punctuation">(</span><span class="token string">&quot;didi&quot;</span><span class="token punctuation">)</span>
<span class="token comment">#åœ¨è¿™æ ·ä½¿ç”¨æ—¶ä¼šå¯¼è‡´åç¨‹ä¸å®‰å…¨æ‰€ä»¥ä½¿ç”¨é”</span>
</code></pre></div><h3 id="aioå¼‚æ­¥çˆ¬è™«"><a href="#aioå¼‚æ­¥çˆ¬è™«" aria-hidden="true" class="header-anchor">#</a> aioå¼‚æ­¥çˆ¬è™«</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#-*-coding:utf-8-*-</span>
<span class="token comment">#SettingCode here</span>
__author__ <span class="token operator">=</span> <span class="token string">&quot;a_little_rubbish&quot;</span>
__date__ <span class="token operator">=</span> <span class="token string">&quot;2018/11/23 13:27&quot;</span>

<span class="token comment">#import your model here</span>
<span class="token keyword">import</span> aiohttp
<span class="token keyword">import</span> aiomysql
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> re
<span class="token keyword">from</span> asyncio<span class="token punctuation">.</span>queues <span class="token keyword">import</span> Queue
<span class="token keyword">from</span> pyquery <span class="token keyword">import</span> PyQuery

stop<span class="token operator">=</span><span class="token boolean">False</span>

<span class="token comment">#your class&amp;function here</span>
start_url<span class="token operator">=</span><span class="token string">&quot;http://www.jobbole.com/&quot;</span>
waiting_urls<span class="token operator">=</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æœªçˆ¬å–çš„è¿æ¥</span>
seen_urls<span class="token operator">=</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#å·²çˆ¬å–è¿‡çš„è¿æ¥ï¼Œé‡å¤§å°±ç”¨å¸ƒéš†è¿‡æ»¤å™¨</span>



<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#è·å–url</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">as</span> the_response<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;url status:{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>the_response<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> the_response<span class="token punctuation">.</span>status <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">201</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                data <span class="token operator">=</span><span class="token keyword">await</span> the_response<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> data
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">extract_urls</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">:</span>
    urls<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    pq<span class="token operator">=</span>PyQuery<span class="token punctuation">(</span>html<span class="token punctuation">)</span>
    <span class="token keyword">for</span> links <span class="token keyword">in</span> pq<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        url<span class="token operator">=</span>links<span class="token punctuation">.</span>attr<span class="token punctuation">(</span><span class="token string">&quot;href&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> url <span class="token keyword">and</span> url<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span> <span class="token keyword">and</span> url <span class="token keyword">not</span> <span class="token keyword">in</span> seen_urls<span class="token punctuation">:</span>
            urls<span class="token punctuation">.</span>append<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            <span class="token keyword">await</span> waiting_urls<span class="token punctuation">.</span>put<span class="token punctuation">(</span>url<span class="token punctuation">)</span>



<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">init_urls</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#ç”¨ä½œå¯åŠ¨</span>
    html<span class="token operator">=</span> <span class="token keyword">await</span> fetch<span class="token punctuation">(</span>url<span class="token punctuation">,</span>session<span class="token punctuation">)</span>
    <span class="token keyword">await</span> extract_urls<span class="token punctuation">(</span>html<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">article_handler</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>session<span class="token punctuation">,</span>pool<span class="token punctuation">)</span><span class="token punctuation">:</span>
    html<span class="token operator">=</span><span class="token keyword">await</span> fetch<span class="token punctuation">(</span>url<span class="token punctuation">,</span>session<span class="token punctuation">)</span>
    seen_urls<span class="token punctuation">.</span>add<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">await</span> extract_urls<span class="token punctuation">(</span>html<span class="token punctuation">)</span>
    pq<span class="token operator">=</span>PyQuery<span class="token punctuation">(</span>html<span class="token punctuation">)</span>
    tittle<span class="token operator">=</span>pq<span class="token punctuation">(</span><span class="token string">&quot;tittle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">async</span> <span class="token keyword">with</span> pool<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> conn<span class="token punctuation">:</span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cur<span class="token punctuation">:</span>
            <span class="token keyword">await</span> cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;INSERT INTO tittle VALUE {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tittle<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ok +1&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">consumer</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token keyword">not</span> stop<span class="token punctuation">:</span>
            url<span class="token operator">=</span> <span class="token keyword">await</span> waiting_urls<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;get {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> re<span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string">&quot;http://.*?jobbole.com/\d+/&quot;</span><span class="token punctuation">,</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> url <span class="token keyword">not</span> <span class="token keyword">in</span> seen_urls<span class="token punctuation">:</span>
                    asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span>article_handler<span class="token punctuation">(</span>url<span class="token punctuation">,</span>session<span class="token punctuation">,</span>pool<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> url <span class="token keyword">not</span> <span class="token keyword">in</span> seen_urls<span class="token punctuation">:</span>
                    asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span>init_urls<span class="token punctuation">(</span>url<span class="token punctuation">,</span>session<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>loop<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pool <span class="token operator">=</span> <span class="token keyword">await</span> aiomysql<span class="token punctuation">.</span>create_pool<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">&quot;1118&quot;</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token string">&quot;aiosql&quot;</span><span class="token punctuation">,</span> loop<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                                charset<span class="token operator">=</span><span class="token string">&quot;utf8&quot;</span><span class="token punctuation">,</span> autocommit<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
        html<span class="token operator">=</span> <span class="token keyword">await</span> fetch<span class="token punctuation">(</span>start_url<span class="token punctuation">,</span>session<span class="token punctuation">)</span>
        seen_urls<span class="token punctuation">.</span>add<span class="token punctuation">(</span>start_url<span class="token punctuation">)</span>
        <span class="token keyword">await</span> extract_urls<span class="token punctuation">(</span>html<span class="token punctuation">)</span>
    asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span>consumer<span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    loop<span class="token operator">=</span>asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span>main<span class="token punctuation">(</span>loop<span class="token punctuation">)</span><span class="token punctuation">)</span>
    loop<span class="token punctuation">.</span>run_forever<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="å¼‚æ­¥æ’å…¥æ•°æ®åº“"><a href="#å¼‚æ­¥æ’å…¥æ•°æ®åº“" aria-hidden="true" class="header-anchor">#</a> å¼‚æ­¥æ’å…¥æ•°æ®åº“</h3> <p>åœ¨scrapyä¸­å¼‚æ­¥æ’å…¥mysqlçœ‹<a href>è¿™é‡Œ</a></p> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>ç•™å‘</p></div> <h2 id="åç»­å°†æŒç»­æ›´æ–°"><a href="#åç»­å°†æŒç»­æ›´æ–°" aria-hidden="true" class="header-anchor">#</a> åç»­å°†æŒç»­æ›´æ–°</h2> <div id="vcomments"></div></div> <!----> <!----> <!----> <div class="page-edit" data-v-cdcae5a4><!----> <div class="last-updated" data-v-cdcae5a4><span class="prefix" data-v-cdcae5a4>Last Updated: </span> <span class="time" data-v-cdcae5a4>12/29/2019, 3:00:55 PM</span></div></div> <div class="page-nav" data-v-cdcae5a4><p class="inner" data-v-cdcae5a4><!----> <span class="next" data-v-cdcae5a4><a href="/blog/back/python/pythonå®æˆ˜æé«˜.html" data-v-cdcae5a4>
          pythonå®æˆ˜æé«˜
        </a>
        â†’
      </span></p></div> </div> <div class="valine-wrapper" data-v-63f18ac0><div id="valine" style="display:;" data-v-63f18ac0></div></div> <!----> <!----> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-41016a8b data-v-41016a8b><i class="iconfont reco-up" data-v-41016a8b></i></div></div></div></div>
    <script src="/assets/js/app.64171550.js" defer></script><script src="/assets/js/68.3b9433a6.js" defer></script><script src="/assets/js/38.34e99c36.js" defer></script>
  </body>
</html>
