(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{350:function(t,s,a){t.exports=a.p+"assets/img/sadsdsa.2fe36ae9.png"},351:function(t,s,a){t.exports=a.p+"assets/img/20200309155155.73e3b7ac.png"},352:function(t,s,a){t.exports=a.p+"assets/img/20200309154827.6421745f.png"},353:function(t,s,a){t.exports=a.p+"assets/img/c.21d01173.png"},354:function(t,s,a){t.exports=a.p+"assets/img/b.e02864ed.png"},355:function(t,s,a){t.exports=a.p+"assets/img/d.ec47dcf0.png"},402:function(t,s,a){"use strict";a.r(s);var n=[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("主要的方面")]),this._v(" "),s("p",[this._v("canal的用法,将mysql增量同步到ES"),s("br"),this._v("\nmysql的binlog订阅机制,主从同步的原理")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"readme"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#readme","aria-hidden":"true"}},[this._v("#")]),this._v(" README")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这篇文章是毕业设计改良搜索引擎的一部分，主要解决的问题是mysql和es的同步问题。我的数据库是直接用django item生成的，如果你自己搭建的话，需要先把表建好，字段和类型规定好。"),s("br"),this._v("\n我用的版本是canal:1.1.4,mysql:5.7,ELK:6.7截至目前。server端支持8+，但是client客户端支持到不知道多少，保险起见我用的mysql5.7(因为用8失败了,用户一直无法登陆上去)，我是用docker直接搭建的ELK，为了方便后期部署也把mysql也放进了这个网络里"),s("br"),this._v("\ncanal需要jdk1.8,在docker里面安装")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"es搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#es搭建","aria-hidden":"true"}},[this._v("#")]),this._v(" ES搭建")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("用的这个repo,docker-compose可以直接搭建"),s("br"),this._v(" "),s("code",[this._v("https://github.com/deviantony/docker-elk.git")]),s("br"),this._v("\n下载好之后有几个地方需要改")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[s("strong",[this._v("所有的密码为changeme的地方改为你自己想要的密码")])]),this._v(" "),s("li",[this._v("修改分配的内存大小,建议ES给2g,logstash给1G")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elasticsearch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ES_JAVA_OPTS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-Xmx2g -Xms2g"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logstash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("LS_JAVA_OPTS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-Xmx1g -Xms1g"')]),t._v("\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("注意")]),this._v(" "),s("p",[this._v("因为es容器内部是以elasticsearch用户启动进程的，所以在做持久化数据目录挂载的时候，需要将目录权限进行设置，否则会因为没有访问权限而启动失败。elasticsearch的uid是1000，可以建一个uid为1000的用户，然后将目录所有者赋予该用户。"),s("br"),this._v("\n你要是懒就直接755")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"3"}},[s("li",[this._v("禁用付费功能")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[this._v("#　elasticsearch/config/elasticsearch.yml")]),this._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[this._v("xpack.license.self_generated.type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(":")]),this._v(" basic\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"4"}},[s("li",[this._v("第一层目录下的"),s("code",[this._v(".env")]),this._v("中决定版本")]),this._v(" "),s("li",[this._v("修改network分配固定ip")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#容器网络上这样配置就可以固定内网ip了")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.70\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bridge\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipam")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这一行往下是新加的 ")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("subnet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.0/24\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ol",{attrs:{start:"6"}},[a("li",[t._v("删掉无用的文件 "),a("code",[t._v(".github")]),t._v(" "),a("code",[t._v(".travis")]),t._v(" "),a("code",[t._v(".gitattributes")]),t._v(" "),a("code",[t._v(".travis.yml")]),t._v(" "),a("code",[t._v("LICENSE")]),t._v(" "),a("code",[t._v("README.md")]),t._v(" "),a("code",[t._v("docker-stack.yml")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3.2'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elasticsearch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("context")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" elasticsearch/\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("args")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ELK_VERSION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $ELK_VERSION\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" KGelasticsearch\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bind\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./elasticsearch/config/elasticsearch.yml\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /usr/share/elasticsearch/config/elasticsearch.yml\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("read_only")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" volume\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" elasticsearch\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /usr/share/elasticsearch/data\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9200:9200"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9300:9300"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ES_JAVA_OPTS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-Xmx2g -Xms2g"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分配内存")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ELASTIC_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"chamgeme"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 改下ES密码")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Use single node discovery in order to disable production mode and avoid bootstrap checks")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# see https://www.elastic.co/guide/en/elasticsearch/reference/current/bootstrap-checks.html")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("discovery.type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" single"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("node\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.10 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分配ip")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logstash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("context")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" logstash/\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("args")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ELK_VERSION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $ELK_VERSION\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" KGlogstash\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bind\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./logstash/config/logstash.yml\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /usr/share/logstash/config/logstash.yml\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("read_only")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bind\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./logstash/pipeline\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /usr/share/logstash/pipeline\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("read_only")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5000:5000/tcp"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5000:5000/udp"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9600:9600"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("LS_JAVA_OPTS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-Xmx1g -Xms1g"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.20 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分配ip")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("depends_on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" elasticsearch\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kibana")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("context")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kibana/\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("args")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ELK_VERSION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $ELK_VERSION\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" KGkibana\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bind\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./kibana/config/kibana.yml\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /usr/share/kibana/config/kibana.yml\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("read_only")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5601:5601"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.30 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分配ip")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("depends_on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" elasticsearch\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mysql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.7")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" KGsql\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privileged")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/mysql57/my.cnf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/mysql/my.cnf \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/mysql57/conf.d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/mysql/conf.d \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/mysql57/data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/lib/mysql \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/mysql57/logs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/log/mysql \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("elk/canal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/canal "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重要:这个目录用来放canal")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3306:3306"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"11112:11112"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.40 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分配ip")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'changeme'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_USER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'canal'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这个参数可以提前创建一个除root外的用户")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'canal'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这个额外用户的密码,一会连接要用到")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("character"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("set"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("collation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4_general_ci\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("explicit_defaults_for_timestamp=true\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lower_case_table_names=1\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("max_allowed_packet=128M\n\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("redis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" redis\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" KGredis\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privileged")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server /etc/redis/redis.conf\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/redisdata/redis.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/redis/redis.conf \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/redisdata/data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/data\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/redisdata/logs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/log/redis \n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6379:6379"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.50 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分配ip")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nginx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" KGnginx\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privileged")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/nginx/conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/nginx/conf.d \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/nginx/nginx.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/nginx/nginx.conf \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/nginx/html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/usr/share/nginx/html \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/nginx/logs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/log/nginx \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("elk/proj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/proj "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 以后放项目用")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"80:80"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"443:443"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"81:81"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.60 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分配ip")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("neo4j")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" neo4j\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" KGneo4j\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privileged")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/neo4j/data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/data \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/neo4j/import"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/import \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/neo4j/logs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/logs \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/neo4j/conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/conf \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /home/ooowl/Documents/DBdata/neo4j/plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/plugins \n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"7474:7474"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"7687:7687"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.70 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分配ip")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bridge\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipam")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分配网络")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("subnet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.0/24 \n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 默认的数据卷,存放es的数据")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("elasticsearch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("最后在docker-compose.yml的目录运行"),s("code",[this._v("docker-compose up -d")]),s("br"),this._v("\n强烈建议安装portainer,好操作一些,如果出错了查看日志"),s("code",[this._v("docker logs container_id")]),this._v("\n访问各个端口9200,5601,3306,80之类的看看正常吗")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"mysql配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql配置","aria-hidden":"true"}},[this._v("#")]),this._v(" mysql配置")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("先进入mysql\n"),s("code",[this._v("docker exec -it 容器name或id /bin/bash")]),s("br"),this._v("\n进去之后先ping一下看看网络通不通(ping命令需要安装)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"修改源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改源","aria-hidden":"true"}},[this._v("#")]),this._v(" 修改源")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("你可以在里面直接vim编辑但是需要先下载vim,我用canal那个文件夹,直接在外面写好源放进去,复制过去就可以了"),s("br"),this._v("\n不细说了,linux基础网上一搜一大把"),s("br"),this._v("\n更新源的时候会报错因为缺少公钥,先运行两个命令")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 3B4FE6ACC0B21F32 && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 40976EAF437D05B5\ncp /etc/apt/sources.list /etc/apt/sources.list.backup && rm /etc/apt/sources.list && cp /canal/sources.list /etc/apt/\napt-get -y update && apt-get -y upgrade\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("mkdir -p /usr/share/man/man1\napt-get -y install vim net-tools inetutils-ping openjdk-8-jdk procps \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"开启binlog"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开启binlog","aria-hidden":"true"}},[this._v("#")]),this._v(" 开启binlog")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("修改mysql的配置文件,在docker里面"),s("code",[this._v("/etc/mysql/conf.d/docker.cnf")]),this._v(",也可以直接在外面更新")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("# 在[mysqld]下面加入\nlog-bin=mysql-bin\nbinlog-format=ROW\nserver-id=1\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("我先前在创建docker的时候创建过了,就不在创建了."),s("br"),this._v("\n授予用户权限和并允许远程登录,因为canal的原理是假装自己是个slave,然后从master那里拿数据再去干别的,所以要给这个用户slave的权限")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("GRANT SELECT,REPLICATION SLAVE,REPLICATION CLIENT ON *.* TO 'canal'@'%';\nFLUSH PRIVILEGES;\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("show variables like '%log_bin%';\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("use mysql;\nselect host, user from user;\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{attrs:{align:"center"}},[s("img",{staticStyle:{height:"350px"},attrs:{src:a(350)}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"canal配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#canal配置","aria-hidden":"true"}},[this._v("#")]),this._v(" canal配置")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{attrs:{align:"center"}},[s("table",{attrs:{border:"0"}},[s("tr",[s("th",[s("img",{staticStyle:{height:"350px"},attrs:{src:a(351)}})]),this._v(" "),s("th",[s("img",{staticStyle:{height:"350px"},attrs:{src:a(352)}})])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"启动server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动server","aria-hidden":"true"}},[this._v("#")]),this._v(" 启动server")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("主程序的配置不要动,修改实例的配置"),s("code",[this._v("instance.properties")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\ncanal.instance.master.address=127.0.0.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306 ")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#保证能从这个访问到mysql就可以")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# canal.instance.tsdb.enable=true #注释掉这个测试数据库")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\ncanal.instance.dbUsername=canal "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 那个用户名")]),t._v("\ncanal.instance.dbPassword=canal "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#那个密码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\ncanal.instance.filter.regex=kg.save_app_saveddata \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用正则匹配的库和表,.*//..*意思时是有库所有表,我这里的配置意思的kg库下的save_app_saveddata表,多表同步没搞")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("example.log")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-log extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v('2020-03-09 05:06:15.075 [main] WARN  c.a.o.canal.parse.inbound.mysql.dbsync.LogEventConvert - --\x3e init table black filter : \n2020-03-09 05:06:15.206 [destination = example , address = /127.0.0.1:3306 , EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - ---\x3e begin to find start position, it will be long time for reset or first position\n2020-03-09 05:06:15.223 [main] INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful....\n2020-03-09 05:06:15.235 [destination = example , address = /127.0.0.1:3306 , EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to find start position just last position\n {"identity":{"slaveId":-1,"sourceAddress":{"address":"localhost","port":3306}},"postion":{"gtid":"","included":false,"journalName":"mysql-bin.000001","position":1184440,"serverId":1,"timestamp":1583729914000}}\n2020-03-09 05:06:15.572 [destination = example , address = /127.0.0.1:3306 , EventParser] WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - ---\x3e find start position successfully, EntryPosition[included=false,journalName=mysql-bin.000001,position=1184440,serverId=1,gtid=,timestamp=1583729914000] cost : 359ms , the next step is binlog dump\n')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("canal.log")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{attrs:{align:"center"}},[s("img",{staticStyle:{height:"100px"},attrs:{src:a(353)}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"启动client"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动client","aria-hidden":"true"}},[this._v("#")]),this._v(" 启动client")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("修改"),s("code",[this._v("application.yml")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jackson")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("date-format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" yyyy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("MM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("dd HH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ss\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("time-zone")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" GMT+8\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("default-property-inclusion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" non_null\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("canal.conf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tcp "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kafka rocketMQ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("canalServerHost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.40"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11111 ")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据库ip,如果你没改过那就是11111端口")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  zookeeperHosts: slave1:2181")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  mqServers: 127.0.0.1:9092 #or rocketmq")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  flatMessage: true")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("batchSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("syncBatchSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("retries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("timeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("accessKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secretKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("srcDataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("defaultDS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jdbc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//192.168.1.40"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3306/kg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),t._v("useUnicode=true "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#数据库uel")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" canal "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 那个新的用户名")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" canal "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 那个新的密码")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("canalAdapters")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("instance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" example "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 就是你server的地址")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("groups")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" g1\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("outerAdapters")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" es\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.1.10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9300 ")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 你的es地址")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("properties")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cluster.name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 你的es名称,访问9200会有,如果不对会报错")]),t._v("\n \n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"2"}},[s("li",[this._v("修改"),s("code",[this._v("example.yml")]),s("br"),this._v("\n实例文件会自动读取,改名也不要紧,他会自动读取所有的yml")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSourceKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" defaultDS "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#从 主文件那个数据源读取")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("destination")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" example "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对应server的实例的名字")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" g1 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 默认就行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("esMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("_index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" sifoudata "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 要插入的索引名称")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("_type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" _doc\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("_id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" _id "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这个id就是es的唯一id,如果你想要主键充当id,应该在sql下写明,比如我")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("upsert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select a.id as _id, a.types, a.author_name, a.author_id, a.author_link, a.tags, a.likes, a.favorite, a.release_time, a.article_link, a.title, a.content from save_app_saveddata a"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("commitBatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30 ")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对应创建索引的json")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   "mappings": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#     "_doc": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#         "properties": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "types": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "keyword"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "author_name": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "keyword"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "author_id": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "keyword"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "author_link": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "keyword"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "tags": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "keyword"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "likes": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "integer"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "favorite": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "integer"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "release_time": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "keyword"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "article_link": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "keyword"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "title": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "text"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           },")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#           "content": {')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#             "type": "text"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#           }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#         }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# }")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"danger custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("WARNING")]),this._v(" "),s("p",[this._v("先在ES中创建索引,sql表清空")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"3"}},[s("li",[this._v("输出日志表示你成功了\n"),s("strong",[this._v("adapter.log")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{attrs:{align:"center"}},[s("img",{staticStyle:{height:"420px"},attrs:{src:a(354)}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"遇到的坑"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#遇到的坑","aria-hidden":"true"}},[this._v("#")]),this._v(" 遇到的坑")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"用户名密码错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户名密码错误","aria-hidden":"true"}},[this._v("#")]),this._v(" 用户名密码错误")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("org.h2.jdbc.JdbcSQLException: Wrong user name or password [28000-196]\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("解决办法:删除"),s("code",[this._v("canal.deployer-1.1.4/conf/example/h2.mv.db")]),this._v("重新运行")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"更新机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新机制","aria-hidden":"true"}},[this._v("#")]),this._v(" 更新机制")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("INSERT:只有变更后的值。")]),this._v(" "),s("li",[this._v("UPDATE:包含了变更前、变更后的值。")]),this._v(" "),s("li",[this._v("DELETE:变更前的值")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"选型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#选型","aria-hidden":"true"}},[this._v("#")]),this._v(" 选型")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{attrs:{align:"center"}},[s("img",{staticStyle:{height:"620px"},attrs:{src:a(355)}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"引用参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引用参考","aria-hidden":"true"}},[this._v("#")]),this._v(" 引用参考")])}],e=a(0),r=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._m(10),t._v(" "),t._m(11),t._m(12),t._v(" "),a("details",[a("summary",[a("B",[a("I",{staticStyle:{cursor:"pointer",color:"#0e5870"}},[t._v("这里贴出我的 docker-compose.yml")])],1)],1),t._v(" "),t._m(13)]),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),a("p",[t._v("直接安装jdk会报错,因为默认少个文件夹手动建立一个")]),t._v(" "),t._m(20),a("p",[t._v("输入java和javac试试行不行")]),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._m(24),t._v(" "),t._m(25),a("p",[t._v("重启mysql后检查binlog是否正常启动")]),t._v(" "),t._m(26),a("p",[t._v("查看用户是否可以远程登录")]),t._v(" "),t._m(27),t._m(28),t._v(" "),a("p",[t._v("mysql就配置完毕了")]),t._v(" "),t._m(29),t._v(" "),a("p",[t._v("我是直接把外面一个目录映射到里面去，然后在外面改的配置里面重启软件就可以生效，然后把server,client都放到里面，调试好就可以运行了,你只要保证这玩意能访问ES和mysql就可以"),a("br"),t._v("\n这里"),a("a",{attrs:{href:"https://github.com/alibaba/canal/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载"),a("OutboundLink")],1),t._v(",adapter和deployer")]),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),a("p",[t._v("进入server的文件夹,bin是执行的目录,conf是配置,我们主要改conf")]),t._v(" "),t._m(32),t._v(" "),t._m(33),a("p",[t._v("查看那俩日志,出现这样的就对了,不对就照着日志改")]),t._v(" "),t._m(34),t._v(" "),t._m(35),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),a("p",[t._v("进入client的文件夹,bin是执行的目录,conf是配置,我们主要改conf")]),t._v(" "),t._m(39),t._v(" "),t._m(40),t._m(41),t._v(" "),t._m(42),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),a("p",[t._v("版本不用我多说,错了不兼容的直接连不上")]),t._v(" "),t._m(47),t._v(" "),t._m(48),t._m(49),t._v(" "),t._m(50),t._v(" "),a("p",[t._v("基于 row 模式的 binlog 会不会记录变更前、变更后的值呢？")]),t._v(" "),t._m(51),t._v(" "),t._m(52),t._v(" "),t._m(53),t._v(" "),t._m(54),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.bilibili.com/video/av82844749",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.bilibili.com/video/av82844749"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000019066098",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://segmentfault.com/a/1190000019066098"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/alibaba/canal/wiki/Sync-ES",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/alibaba/canal/wiki/Sync-ES"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.im/post/5d0dfec56fb9a07ed064bb6f#heading-3",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://juejin.im/post/5d0dfec56fb9a07ed064bb6f#heading-3"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/laoyang360/article/details/88600799#commentBox",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://blog.csdn.net/laoyang360/article/details/88600799#commentBox"),a("OutboundLink")],1),t._v(" "),a("Valine")],1)])])},n,!1,null,null,null);s.default=r.exports}}]);